{
	"name": "dataflow3",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "psfileds",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "Parquet3",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Parquet4",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "Union1"
				}
			],
			"script": "source(output(\n\t\thpi_deliverypriorities as integer,\n\t\thpi_assetid as string,\n\t\thpi_ordernumber as string,\n\t\thpi_zippostalcode as string,\n\t\tstatuscode as integer,\n\t\thpi_partsorderid as string,\n\t\thpi_globalshipmentcondition as integer,\n\t\tcreatedon as timestamp,\n\t\thpi_deliveryinstructions as string,\n\t\thpi_formopenedfirsttime as boolean,\n\t\thpi_serialnumber as string,\n\t\thpi_workorderid as string,\n\t\townerid as string,\n\t\thpi_badgenumber as string,\n\t\tmodifiedon as timestamp,\n\t\thpi_safariid as string,\n\t\thpi_addessvalidated as boolean,\n\t\tstatecode as integer,\n\t\thpi_chooseaddresses as integer,\n\t\thpi_deliverycomplete as boolean,\n\t\thpi_isplaceorder as boolean,\n\t\ttimezoneruleversionnumber as integer,\n\t\thpi_orderstatus as integer,\n\t\tmodifiedby as string,\n\t\thpi_countryshortcode as string,\n\t\thpi_name as string,\n\t\thpi_country as string,\n\t\thpi_otccodeid as string,\n\t\thpi_partrequesteddate as timestamp,\n\t\thpi_globalsupplychain as integer,\n\t\tversionnumber as long,\n\t\thpi_ispoaddressupdate as boolean,\n\t\thpi_orderreason as integer,\n\t\tcreatedby as string,\n\t\towningbusinessunit as string,\n\t\towninguser as string,\n\t\thpi_ribbonprocessing as boolean,\n\t\thpi_site as string,\n\t\thpi_shippingcondition as integer,\n\t\thpi_contactid as string,\n\t\thpi_partdescription as string,\n\t\thpi_caseid as string,\n\t\thpi_entitlementstatus as integer,\n\t\thpi_startdate as timestamp,\n\t\thpi_caseofferid as string,\n\t\thpi_partnumber as string,\n\t\thpi_caseentitlementid as string,\n\t\thpi_daysleft as integer,\n\t\thpi_enddate as timestamp,\n\t\thpi_receiveddateandtime as timestamp,\n\t\thpi_sitepatnerid as string,\n\t\thpi_fraudcheckdescription as string,\n\t\thpi_productname as string,\n\t\thpi_fraudcheckcount as integer,\n\t\thpi_division as string,\n\t\thpi_fraudcheckstatus as integer,\n\t\thpi_latest_date as string,\n\t\thpi_partorderid as string,\n\t\thpi_usage as string,\n\t\thpi_line1 as string,\n\t\thpi_distributionchannel as string,\n\t\thpi_servicenotificationidentifier as string,\n\t\thpi_ordercloseddate as timestamp,\n\t\thpi_fraudcheckholdreason as integer,\n\t\thpi_city as string,\n\t\tcreatedonbehalfby as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> source1\nsource(output(\n\t\tcreatedby as string,\n\t\tcreatedbyname as string,\n\t\tcreatedbyyominame as string,\n\t\tcreatedon as timestamp,\n\t\tcreatedonbehalfby as string,\n\t\tcreatedonbehalfbyname as string,\n\t\tcreatedonbehalfbyyominame as string,\n\t\texchangerate as double,\n\t\thpi_addessvalidated as boolean,\n\t\thpi_addessvalidatedname as string,\n\t\thpi_advisoryid as string,\n\t\thpi_amid2 as string,\n\t\thpi_amid4 as string,\n\t\thpi_assetid as string,\n\t\thpi_assetidname as string,\n\t\thpi_authorizedemployee as string,\n\t\thpi_autoclosedate as timestamp,\n\t\thpi_badgenumber as string,\n\t\thpi_badgenumbername as string,\n\t\thpi_billblock as string,\n\t\thpi_carrier as string,\n\t\thpi_caseentitlementid as string,\n\t\thpi_caseentitlementidname as string,\n\t\thpi_caseid as string,\n\t\thpi_caseidname as string,\n\t\thpi_caseoffer as string,\n\t\thpi_caseofferid as string,\n\t\thpi_caseofferidname as string,\n\t\thpi_caseoffername as string,\n\t\thpi_chooseaddress as integer,\n\t\thpi_chooseaddresses as integer,\n\t\thpi_chooseaddressesname as string,\n\t\thpi_chooseaddressname as string,\n\t\thpi_city as string,\n\t\thpi_companyname as string,\n\t\thpi_contactfirstname as string,\n\t\thpi_contactid as string,\n\t\thpi_contactidname as string,\n\t\thpi_contactidyominame as string,\n\t\thpi_contactlastname as string,\n\t\thpi_contract_baseline as string,\n\t\thpi_country as string,\n\t\thpi_countryname as string,\n\t\thpi_countryshortcode as string,\n\t\thpi_csrid as string,\n\t\thpi_csridname as string,\n\t\thpi_cust_grp5 as string,\n\t\thpi_customer_site as string,\n\t\thpi_customerselfrepairid as string,\n\t\thpi_customerselfrepairidname as string,\n\t\thpi_daysleft as integer,\n\t\thpi_deliverycomplete as boolean,\n\t\thpi_deliverycompletename as string,\n\t\thpi_deliveryinstructions as string,\n\t\thpi_deliverypriorities as integer,\n\t\thpi_deliveryprioritiesname as string,\n\t\thpi_deliverypriority as integer,\n\t\thpi_deliverypriorityname as string,\n\t\thpi_distributionchannel as string,\n\t\thpi_division as string,\n\t\thpi_dlv_block as string,\n\t\thpi_dropbox as string,\n\t\thpi_dropboxname as string,\n\t\thpi_emailaddress as string,\n\t\thpi_enddate as timestamp,\n\t\thpi_entitlementoverridereasonid as string,\n\t\thpi_entitlementoverridereasonidname as string,\n\t\thpi_entitlementstatus as integer,\n\t\thpi_entitlementstatusname as string,\n\t\thpi_expecteddeliverydate as timestamp,\n\t\thpi_formopenedfirsttime as boolean,\n\t\thpi_formopenedfirsttimename as string,\n\t\thpi_fraudcheckcount as integer,\n\t\thpi_fraudcheckdescription as string,\n\t\thpi_fraudcheckholddetails as string,\n\t\thpi_fraudcheckholdreason as integer,\n\t\thpi_fraudcheckholdreasonname as string,\n\t\thpi_fraudcheckstatus as integer,\n\t\thpi_fraudcheckstatusname as string,\n\t\thpi_globalshipmentcondition as integer,\n\t\thpi_globalshipmentconditionname as string,\n\t\thpi_globalspecialprocess as integer,\n\t\thpi_globalspecialprocessname as string,\n\t\thpi_globalsupplychain as integer,\n\t\thpi_globalsupplychainname as string,\n\t\thpi_id as string,\n\t\thpi_isplaceorder as boolean,\n\t\thpi_isplaceordername as string,\n\t\thpi_ispoaddressupdate as boolean,\n\t\thpi_ispoaddressupdatename as string,\n\t\thpi_latest_date as string,\n\t\thpi_latestdatetime as timestamp,\n\t\thpi_line1 as string,\n\t\thpi_line2 as string,\n\t\thpi_logisticorderidentifier as string,\n\t\thpi_mc_flag as string,\n\t\thpi_message as string,\n\t\thpi_name as string,\n\t\thpi_netordervalue as double,\n\t\thpi_netordervalue_base as double,\n\t\thpi_nfid as string,\n\t\thpi_obligationid as string,\n\t\thpi_order_reason_code as string,\n\t\thpi_orderaddress as integer,\n\t\thpi_orderaddressname as string,\n\t\thpi_ordercloseddate as timestamp,\n\t\thpi_ordernumber as string,\n\t\thpi_orderreason as integer,\n\t\thpi_orderreasonname as string,\n\t\thpi_orderstatus as integer,\n\t\thpi_orderstatuscode as string,\n\t\thpi_orderstatusname as string,\n\t\thpi_originator as string,\n\t\thpi_otccodeid as string,\n\t\thpi_otccodeidname as string,\n\t\thpi_overridereason as string,\n\t\thpi_parentpartorderid as string,\n\t\thpi_parentpartorderidname as string,\n\t\thpi_part_delivery_timestamp as timestamp,\n\t\thpi_partdescription as string,\n\t\thpi_partnumber as string,\n\t\thpi_partorderid as string,\n\t\thpi_partrequesteddate as timestamp,\n\t\thpi_partsorderid as string,\n\t\thpi_paymentterms as string,\n\t\thpi_pendingtransactiontype as string,\n\t\thpi_phonenumber as string,\n\t\thpi_pricingdate as timestamp,\n\t\thpi_productname as string,\n\t\thpi_productnamename as string,\n\t\thpi_queue as string,\n\t\thpi_queuename as string,\n\t\thpi_receiveddateandtime as timestamp,\n\t\thpi_remotediagnosticscode as string,\n\t\thpi_requesteddate as timestamp,\n\t\thpi_ribbonprocessing as boolean,\n\t\thpi_ribbonprocessingname as string,\n\t\thpi_safariid as string,\n\t\thpi_salesorg as string,\n\t\thpi_securitystatuscode as string,\n\t\thpi_serialnumber as string,\n\t\thpi_service_flag as string,\n\t\thpi_service_type as string,\n\t\thpi_serviceidentificationnumber as string,\n\t\thpi_servicenotificationidentifier as string,\n\t\thpi_serviceorderid as string,\n\t\thpi_serviceorderidname as string,\n\t\thpi_shipping_carrier_code as string,\n\t\thpi_shipping_condition_code as string,\n\t\thpi_shippingcondition as integer,\n\t\thpi_shippingconditionname as string,\n\t\thpi_shippinginstructions as integer,\n\t\thpi_shippinginstructionsname as string,\n\t\thpi_site as string,\n\t\thpi_site_name as string,\n\t\thpi_sitename as string,\n\t\thpi_sitepatnerid as string,\n\t\thpi_sitepatneridname as string,\n\t\thpi_siteyominame as string,\n\t\thpi_sku as string,\n\t\thpi_startdate as timestamp,\n\t\thpi_stateprovince as string,\n\t\thpi_systemproductnumber as string,\n\t\thpi_systemserialnumber as string,\n\t\thpi_timezone as integer,\n\t\thpi_trackingnumber as string,\n\t\thpi_usage as string,\n\t\thpi_workorderid as string,\n\t\thpi_workorderidname as string,\n\t\thpi_zipextension as string,\n\t\thpi_zippostalcode as string,\n\t\timportsequencenumber as integer,\n\t\tmodifiedby as string,\n\t\tmodifiedbyname as string,\n\t\tmodifiedbyyominame as string,\n\t\tmodifiedon as timestamp,\n\t\tmodifiedonbehalfby as string,\n\t\tmodifiedonbehalfbyname as string,\n\t\tmodifiedonbehalfbyyominame as string,\n\t\toverriddencreatedon as timestamp,\n\t\townerid as string,\n\t\towneridname as string,\n\t\towneridtype as string,\n\t\towneridyominame as string,\n\t\towningbusinessunit as string,\n\t\towningteam as string,\n\t\towninguser as string,\n\t\tstatecode as integer,\n\t\tstatecodename as string,\n\t\tstatuscode as string,\n\t\tstatuscodename as string,\n\t\ttimezoneruleversionnumber as integer,\n\t\ttransactioncurrencyid as string,\n\t\ttransactioncurrencyidname as string,\n\t\tutcconversiontimezonecode as integer,\n\t\tversionnumber as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> source2\nsource1 derive(statuscode = toString(statuscode)) ~> DerivedColumn1\nDerivedColumn1, source2 union(byName: true)~> Union1\nUnion1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['harishparquetoutput.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}