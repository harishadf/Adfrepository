{
	"name": "ECOLABDATALAKE_O2C_AGING_FACT_DAILY",
	"properties": {
		"folder": {
			"name": "Analytics/O2CAZ"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "OToCAgingCntlDaily"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "SoldToPayerLookup"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "BillingSoldTolookup"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "DimCustomer"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "DimBaseCustomerHierarchy"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "SalesLkpCustomerXref"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "LIS13VDITM"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "FIAR4"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "sink1"
				},
				{
					"dataset": {
						"referenceName": "Parquet_Dataset",
						"type": "DatasetReference"
					},
					"name": "sink2"
				},
				{
					"dataset": {
						"referenceName": "Delimited_Dataset",
						"type": "DatasetReference"
					},
					"name": "sink3"
				}
			],
			"transformations": [
				{
					"name": "cnt1"
				},
				{
					"name": "Filter1"
				},
				{
					"name": "maxdate"
				},
				{
					"name": "Window1"
				},
				{
					"name": "Filter2"
				},
				{
					"name": "SoldToPayerLookup1"
				},
				{
					"name": "Window2"
				},
				{
					"name": "Filter3"
				},
				{
					"name": "BillingSoldTolookup1"
				},
				{
					"name": "Window3"
				},
				{
					"name": "Filter4"
				},
				{
					"name": "Customer"
				},
				{
					"name": "Window4"
				},
				{
					"name": "Filter5"
				},
				{
					"name": "Customerhier"
				},
				{
					"name": "Window5"
				},
				{
					"name": "Filter6"
				},
				{
					"name": "Customerxref"
				},
				{
					"name": "Window6"
				},
				{
					"name": "Filter7"
				},
				{
					"name": "BillingDocumentItemData"
				},
				{
					"name": "CrossJoinMaxDate"
				},
				{
					"name": "Filter8"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "AgingExplExtract1"
				},
				{
					"name": "LeftJoinbillingsoldto"
				},
				{
					"name": "LeftJoinsoldtopayer"
				},
				{
					"name": "LeftJoinBillingDocumentItemDataU1"
				},
				{
					"name": "LeftJoinBillingDocumentItemDataNonU1"
				},
				{
					"name": "Select1"
				},
				{
					"name": "DerivedColumn2"
				},
				{
					"name": "LogicPopulation"
				},
				{
					"name": "LeftJoinsoldtocust"
				},
				{
					"name": "LeftJoinpayercust"
				},
				{
					"name": "LeftJoinsoldtocusthier"
				},
				{
					"name": "LeftJoinpayercusthier"
				},
				{
					"name": "LeftJoinCustomerxref"
				},
				{
					"name": "LeftJoinBillTo"
				},
				{
					"name": "DerivedColumn3"
				},
				{
					"name": "FinalDailySet"
				},
				{
					"name": "DerivedColumn4"
				},
				{
					"name": "FinalDailySetWithoutColumn"
				},
				{
					"name": "FinalDailySetWithoutColumn1"
				},
				{
					"name": "FinalDailySetWithoutColumn2"
				},
				{
					"name": "getoldcntlvalue"
				},
				{
					"name": "DerivedColumn5"
				},
				{
					"name": "Aggregate1"
				},
				{
					"name": "getnewcntlvalue"
				},
				{
					"name": "Union1"
				},
				{
					"name": "Select4"
				},
				{
					"name": "Select5"
				},
				{
					"name": "soldtocust"
				},
				{
					"name": "payercust"
				},
				{
					"name": "BillTo"
				},
				{
					"name": "BillingDocumentItemDataU1"
				},
				{
					"name": "BillingDocumentItemDataNonU1"
				},
				{
					"name": "soldtocusthier"
				},
				{
					"name": "payercusthier"
				},
				{
					"name": "finaldailysetwithoutcolumn2select"
				},
				{
					"name": "Filter10"
				},
				{
					"name": "Filter11"
				}
			],
			"script": "parameters{\n\tpath_OToC_Aging_Cntl_Daily as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tfile_OToC_Aging_Cntl_Daily as string ('OToC_Aging_Cntl_DailyEU'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tpath_soldtopayerlookup as string ('Exploration/EnterpriseBackbone/O2C_Lookup/'),\n\tfile_soldtopayerlookup as string ('soldtopayerlookup'),\n\tfile_BillingSoldTolookup as string ('BillingSoldTolookup'),\n\tpath_dim_customer as string ('Analytics/EnterpriseCertified/EnterpriseDims/CUSTOMER_NA/'),\n\tfile_dim_customer as string ('dim_customer'),\n\tpath_dim_base_customer_hierarchy as string ('Analytics/EnterpriseCertified/EnterpriseDims/MDM_CUSTOMER_NA/'),\n\tfile_dim_base_customer_hierarchy as string ('dim_base_customer_hierarchy'),\n\tpath_SALES_LKP_CUSTOMER_XREF as string ('Exploration/EnterpriseBackbone/Lookups/USHistoricalSalesData/'),\n\tfile_SALES_LKP_CUSTOMER_XREF as string ('SALES_LKP_CUSTOMER_XREF'),\n\tpath_2LIS_13_VDITM as string ('Exploration/EnterpriseBackbone/EBS/2LIS_13_VDITM/CurrentDelta/EU/'),\n\tfile_2LIS_13_VDITM as string ('2LIS_13_VDITM*'),\n\tpath_0FI_AR_4 as string ('Exploration/EnterpriseBackbone/EBS/0FI_AR_4/CurrentDelta/EU/*/*/*/'),\n\tfile_0FI_AR_4 as string ('0FI_AR_4*'),\n\tpath_BillingSoldTolookup as string ('Exploration/EnterpriseBackbone/O2C_Lookup/'),\n\tfile_AR_Transactions as string ('AR_Transactions'),\n\tpath_AR_Transactions as string ('Analytics/EnterpriseCertified/EnterpriseFacts/Accounts_Receivable/AR_Transactions/EU/'),\n\tdelta_folder_path as string,\n\tJobId as string ('1'),\n\tParquet_folder as string,\n\ttsv_folder as string,\n\tSubjectAreacntl as string ('Aging_DailyEU')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_OToC_Aging_Cntl_Daily+$file_OToC_Aging_Cntl_Daily+$file_extension_tsv)]) ~> OToCAgingCntlDaily\nsource(output(\n\t\tPayer as string,\n\t\tSoldTo as string,\n\t\tcountofsoldto as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_soldtopayerlookup+$file_soldtopayerlookup+$file_extension_tsv)]) ~> SoldToPayerLookup\nsource(output(\n\t\tBillingDocNum as string,\n\t\tSoldTo as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_BillingSoldTolookup+$file_BillingSoldTolookup+$file_extension_tsv)]) ~> BillingSoldTolookup\nsource(output(\n\t\tCustomerKey as long,\n\t\tCustomerNum as string,\n\t\tAddrNum as string,\n\t\tTitleTxt as string,\n\t\tCustCentralOrderBlockCd as string,\n\t\tExpressTrainStationCd as string,\n\t\tTrainStationCd as string,\n\t\tInternationalLocation1Num as string,\n\t\tInternationalLocation2Num as string,\n\t\tAuthGrpCd as string,\n\t\tIndustryCd as string,\n\t\tInternationalLocationNumCheckDigitCd as string,\n\t\tLineNumDataCommunicationTxt as string,\n\t\tRecordCreatedDt as string,\n\t\tRecordCreatedByName as string,\n\t\tUnloadingPointInd as string,\n\t\tCustCentralBillingBlockCd as string,\n\t\tMasterRecordWithFiscalAddrAccountNum as string,\n\t\tWorkingTmCalendarCd as string,\n\t\tAlternativePayerAccountNum as string,\n\t\tGrpCd as string,\n\t\tCustAccountGrpCd as string,\n\t\tCustClassificationCd as string,\n\t\tCountryKeyCd as string,\n\t\tVendorAccountNum as string,\n\t\tCustCntralDeliveryBlockCd as string,\n\t\tCityCoordinatesVal as string,\n\t\tMasterRecordDeletionInd as string,\n\t\tName1Desc as string,\n\t\tName2Desc as string,\n\t\tName3Desc as string,\n\t\tName4Desc as string,\n\t\tNielsenIDCd as string,\n\t\tCityName as string,\n\t\tDistrictName as string,\n\t\tPOBoxNum as string,\n\t\tPOBoxPostalCd as string,\n\t\tPostalCd as string,\n\t\tRegionCd as string,\n\t\tCountryCd as string,\n\t\tCityCd as string,\n\t\tRegionalMarketCd as string,\n\t\tSortFieldDesc as string,\n\t\tCentralPostingBlockInd as string,\n\t\tLanguageCd as string,\n\t\tTax1Num as string,\n\t\tTax2Num as string,\n\t\tBusPartnerEqualizationTaxInd as string,\n\t\tLiableForVATInd as string,\n\t\tHouseNumAndStreetDesc as string,\n\t\tTeleboxNumTxt as string,\n\t\tFirstTelNum as string,\n\t\tSecondTelNum as string,\n\t\tFaxNum as string,\n\t\tTeletaxNum as string,\n\t\tTelexNum as string,\n\t\tTransportationZoneCd as string,\n\t\tIsOneTimeAccountInd as string,\n\t\tIfAlternativePayeeAllowedInd as string,\n\t\tTradingPartnerCompanyCd as string,\n\t\tVATRegistrationNum as string,\n\t\tIsCompetitorInd as string,\n\t\tIsSalesPartnerInd as string,\n\t\tIsSalesProspectInd as string,\n\t\tCustType4Ind as string,\n\t\tSoldToPartyCd as string,\n\t\tIsConsumerInd as string,\n\t\tLegalStatusCd as string,\n\t\tIndustry1Cd as string,\n\t\tIndustry2Cd as string,\n\t\tIndustry3Cd as string,\n\t\tIndustry4Cd as string,\n\t\tIndustry5Cd as string,\n\t\tInitialContactCd as string,\n\t\tAnnualSalesNum as string,\n\t\tAnnualSalesYearTxt as string,\n\t\tSalesFigCurCd as string,\n\t\tYearlyCountOfEmpNum as string,\n\t\tYearForNumOfEmpTxt as string,\n\t\tAttr1Cd as string,\n\t\tAttr2Cd as string,\n\t\tAttr3Cd as string,\n\t\tAttr4Cd as string,\n\t\tCustLeadDivisionCd as string,\n\t\tAttr6Cd as string,\n\t\tAttr7Cd as string,\n\t\tAttr8Cd as string,\n\t\tAttr9Cd as string,\n\t\tAttr10Cd as string,\n\t\tNaturalPersonName as string,\n\t\tAnnualSalesNum2 as string,\n\t\tTaxJurisdictionCd as string,\n\t\tMatchCdSearchTerm1Desc as string,\n\t\tMatchCdSearchTerm2Desc as string,\n\t\tMatchCdSearchTerm3Desc as string,\n\t\tFiscalYearVariantCd as string,\n\t\tUsageInd as string,\n\t\tCustInspectionInd as string,\n\t\tOutboundDeliveryNoteInspectionInd as string,\n\t\tReferenceAccountGrpCd as string,\n\t\tPOBoxCityName as string,\n\t\tPlantCd as string,\n\t\tMediumOfDataExchangeInd as string,\n\t\tMediumOfDataExchangeInstructionCd as string,\n\t\tDataTransferStatusInd as string,\n\t\tAssignmentToHierarchyCd as string,\n\t\tPaymentBlockCd as string,\n\t\tCustPlantGrpISRLabelCd as string,\n\t\tNonMilitaryUseInd as string,\n\t\tMilitaryUseInd as string,\n\t\tCustConditionGrp1Cd as string,\n\t\tCustConditionGrp2Cd as string,\n\t\tCustConditionGrp3Cd as string,\n\t\tCustConditionGrp4Cd as string,\n\t\tCustConditionGrp5Cd as string,\n\t\tAlternativePayerUsingAccountNumInd as string,\n\t\tTaxTypeCd as string,\n\t\tTaxNumTypeCd as string,\n\t\tTaxNbr3Cd as string,\n\t\tTaxNbr4Cd as string,\n\t\tICMSExemptCustInd as string,\n\t\tIPIExemptCustInd as string,\n\t\tCustGrpCd as string,\n\t\tCustCFOPCatCd as string,\n\t\tICMSTaxLawCd as string,\n\t\tIPITaxLawCd as string,\n\t\tBiochemicalWarfareForLegalControlInd as string,\n\t\tNuclearProliferationForLegalControlInd as string,\n\t\tNationalSecurityForLegalControlInd as string,\n\t\tMissileTechnologyForLegalControlInd as string,\n\t\tCustCentralSalesBlockInd as string,\n\t\tUniformResourceLocatorTxt as string,\n\t\tNameDesc as string,\n\t\tEBSBilWDlvry as string,\n\t\tBusPartnerCatgCd as string,\n\t\tBusPartnerTypeCd as string,\n\t\tBusPartnerGroupingCd as string,\n\t\tExternalSysBusPartnerNum as string,\n\t\tBusPartnerSearchTerm1Txt as string,\n\t\tBusPartnerSearchTerm2Txt as string,\n\t\tDataOriginTypeCd as string,\n\t\tAddressKeyFormCd as string,\n\t\tCentralArchiveInd as string,\n\t\tBusPartnerCentralBlockCd as string,\n\t\tSalutationTxt as string,\n\t\tBusPartnerContactPermissionCd as string,\n\t\tBusPartnerPrntFrmtCd as string,\n\t\tEBSMSDSLanguage1Cd as string,\n\t\tEBSMSDSLanguage2Cd as string,\n\t\tEBSMSDSLanguage3Cd as string,\n\t\tEBSMSDSLanguage4Cd as string,\n\t\tEBSCPrPoisonClsfCd as string,\n\t\tEBSWEENumCd as string,\n\t\tEBSInvOutputCd as string,\n\t\tEBSCustConditionGrp1Cd as string,\n\t\tEBSCustConditionGrp2Cd as string,\n\t\tEBSCustConditionGrp3Cd as string,\n\t\tEBSCustConditionGrp4Cd as string,\n\t\tEBSCustConditionGrp5Cd as string,\n\t\tEBSBrandOwnerName as string,\n\t\tEBSBrandName as string,\n\t\tEBSCustOutletCd as string,\n\t\tEBSCommercialCd as string,\n\t\tEBSCommercialName as string,\n\t\tEBSSiteNum as string,\n\t\tEBSSiteDesc as string,\n\t\tEBSGenID as string,\n\t\tEBSPersonalHRNum as string,\n\t\tEBSActiveDirectoryAcctName as string,\n\t\tEBSBlanketPONum as string,\n\t\tEBSIntOutletNum as string,\n\t\tEBSBillingWDeliveryCd as string,\n\t\tEBSBillBackClassificationCd as string,\n\t\tEBSPOUOnHeaderCd as string,\n\t\tEBSOrderConfirmCd as string,\n\t\tEBSGTAddrDesc as string,\n\t\tEBSSalesAllocRuleCd as string,\n\t\tEBSTerritoryCd as string,\n\t\tEBSAgreedPriceRequiredCd as string,\n\t\tEBSOwnershipCd as string,\n\t\tEBSCatgCd as string,\n\t\tEBSBusPartnerId as string,\n\t\tEBSSalesSkillCd as string,\n\t\tEBSBCMTypeCd as string,\n\t\tEBSDirectIndirectCustInd as string,\n\t\tEBSBusUnitCd as string,\n\t\tEBSSubBUCd as string,\n\t\tEBSDeliverOnOnlyDesc as string,\n\t\tEBSPalletJackReqdDesc as string,\n\t\tEBSLiftGateReqdDt as string,\n\t\tEBSDeliveryApptReqdCd as string,\n\t\tEBSDeliveryContactPersonName as string,\n\t\tEBSDeliveryContactInfoDesc as string,\n\t\tEBSDeliveryInstruction7Desc as string,\n\t\tEBSDeliveryInstructiont8Desc as string,\n\t\tEBSDeliveryInstructiont9Desc as string,\n\t\tEBSDeliveryInstructiont10Desc as string,\n\t\tEBSDeliveryInstruction11Desc as string,\n\t\tEBSCAMTerritoryCd as string,\n\t\tEBSReportDistributionCd as string,\n\t\tEBSMPPRLinkCd as string,\n\t\tEBSTerritoryCd1 as string,\n\t\tOrgName1 as string,\n\t\tOrgName2 as string,\n\t\tOrgName3 as string,\n\t\tOrgName4 as string,\n\t\tLegalFormOrgName as string,\n\t\tIndustrySectorCd as string,\n\t\tLegalEntityOrgName as string,\n\t\tOrgFoundedDt as string,\n\t\tLiduidationOrgDt as string,\n\t\tIntLocationNum1 as string,\n\t\tIntLocationNum2 as string,\n\t\tCheckDigitForIntLocationNum as string,\n\t\tBusPartnerLastName as string,\n\t\tBusPartnerFirstName as string,\n\t\tOtherLastName as string,\n\t\tBusPartnerBirthName as string,\n\t\tBusPartnerMiddleName as string,\n\t\tAcademicTitleCd as string,\n\t\tNamePrefixCd as string,\n\t\tBusPartnerNickname as string,\n\t\tMiddleInitialTxt as string,\n\t\tNameFormatRuleCountryCd as string,\n\t\tCorrespondenceLanguageCd as string,\n\t\tIfBusPartnerIsMaleInd as string,\n\t\tIfBusPartnerIsFemaleInd as string,\n\t\tBusPartnerBirthplaceName as string,\n\t\tBusPartnerMaritalStatusCd as string,\n\t\tNaturalPersonEmployerName as string,\n\t\tNationalityCd as string,\n\t\tPersonNum as string,\n\t\tIfBusPartnerSexIsNotKnownInd as string,\n\t\tObsoleteField2 as string,\n\t\tBusPartnerLanguageCd as string,\n\t\tBusPartnerBirthDt as string,\n\t\tBusPartnerDeathDt as string,\n\t\tPersonnelNum as string,\n\t\tObsoleteField3 as string,\n\t\tObsoleteField4 as string,\n\t\tGrpName1 as string,\n\t\tGrpName2 as string,\n\t\tSearchHelpField1Name as string,\n\t\tSearchHelpField2Name as string,\n\t\tObjectCreatedByName as string,\n\t\tObjectCreatedDt as string,\n\t\tObjectCreatedTm as string,\n\t\tObjChangedByName as string,\n\t\tObjectLastChangedDt as string,\n\t\tObjectLastChangedTm as string,\n\t\tBusPartnerGUID as string,\n\t\tIfPlannedChangedDocConvertedInd as string,\n\t\tBUT000BPDataValidityStartDt as string,\n\t\tBUT000BPDataValidityEndDt as string,\n\t\tIfBusPartnerIsNaturalPersonInd as string,\n\t\tBPTemplateID as string,\n\t\tBusPartnerCatgTextCd as string,\n\t\tShortDesc as string,\n\t\tMediumDesc as string,\n\t\tLongDesc as string,\n\t\tBusPartnerTextGUID as string,\n\t\tAddrValidFromDt as string,\n\t\tAddrValidToDt as string,\n\t\tFormOfAddrCd as string,\n\t\tCareOfDesc as string,\n\t\tNonPostalCityName as string,\n\t\tDifferentCityCd as string,\n\t\tRegionalStructureGroupingCd as string,\n\t\tCityPostalCd as string,\n\t\tCompanyPostalCd as string,\n\t\tPOBoxWithoutNumInd as string,\n\t\tPOBoxRegionCd as string,\n\t\tPOBoxCountry as string,\n\t\tStreetName as string,\n\t\tStreetNumDesc as string,\n\t\tHouseNum as string,\n\t\tSupplementHouseNum as string,\n\t\tStreet2Name as string,\n\t\tStreet3Name as string,\n\t\tStreet4Name as string,\n\t\tStreet5Name as string,\n\t\tBuildingCd as string,\n\t\tFloorCd as string,\n\t\tRoomAptNum as string,\n\t\tPersonalAddrFlagCd as string,\n\t\tSearchTerm1Txt as string,\n\t\tSearchTerm2Txt as string,\n\t\tFirstTelExtnCd as string,\n\t\tFirstFaxExtnCd as string,\n\t\tExtenstion1Cd as string,\n\t\tExtenstion2Cd as string,\n\t\tAddrTmZoneCd as string,\n\t\tEmailAddrTxt as string,\n\t\tURIFieldForTransferToBWTxt as string,\n\t\tDisplayFrmtTelNum as string,\n\t\tDisplayFrmtFaxNum as string,\n\t\tGeoLocationLongitudeVal as string,\n\t\tGeoLocationLatitudeVal as string,\n\t\tGeoLocationHeightVal as string,\n\t\tGeoLocationDataSourceCd as string,\n\t\tGeoLocationPrecisionCd as string,\n\t\tAddrNum2 as string,\n\t\tOneLineAddrDesc as string,\n\t\tOneLineAddrDesc2 as string,\n\t\tBPAddrLin0Desc as string,\n\t\tBPAddrLin1Desc as string,\n\t\tBPAddrLin2Desc as string,\n\t\tBPAddrLin3Desc as string,\n\t\tBPAddrLin4Desc as string,\n\t\tBPAddrLin5Desc as string,\n\t\tBPAddrLin6Desc as string,\n\t\tBPAddrLin7Desc as string,\n\t\tBPAddrLin8Desc as string,\n\t\tBPAddrLin9Desc as string,\n\t\tPricingHierarchyLevel1 as string,\n\t\tPricingHierarchyLevel1Desc as string,\n\t\tPricingHierarchyLevel2 as string,\n\t\tPricingHierarchyLevel2Desc as string,\n\t\tPricingHierarchyLevel3 as string,\n\t\tPricingHierarchyLevel3Desc as string,\n\t\tPricingHierarchyLevel4 as string,\n\t\tPricingHierarchyLevel4Desc as string,\n\t\tPricingHierarchyLevel5 as string,\n\t\tPricingHierarchyLevel5Desc as string,\n\t\tPricingHierarchyLevel6 as string,\n\t\tPricingHierarchyLevel6Desc as string,\n\t\tPricingHierarchyLevel7 as string,\n\t\tPricingHierarchyLevel7Desc as string,\n\t\tPricingHierLvl1Desc as string,\n\t\tPricingHierLvl2Desc as string,\n\t\tPricingHierLvl3Desc as string,\n\t\tPricingHierLvl4Desc as string,\n\t\tPricingHierLvl5Desc as string,\n\t\tPricingHierLvl6Desc as string,\n\t\tPricingHierLvl7Desc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string,\n\t\tMarketSegment1Desc as string,\n\t\tMarketSegment2Desc as string,\n\t\tEBSInsideDeliveryCd as string,\n\t\tEmailID as string,\n\t\tContactPersonCd as string,\n\t\tTelephoneCd as string,\n\t\tNightTimeDeliveryCd as string,\n\t\tIDNum as string,\n\t\tInstitutionCd as string,\n\t\tIDNumValidStartDt as string,\n\t\tIDNumValidEndDt as string,\n\t\tSalesOrgCd as string,\n\t\tAddress as string,\n\t\tCustNameCityNumber as string,\n\t\tCustNameNumber as string,\n\t\tEBSSiteNumName as string,\n\t\tDunningProcedureCd as string,\n\t\tInstMarketSegment1Desc as string,\n\t\tInstMarketSegment2Desc as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_dim_customer+$file_dim_customer+$file_extension_tsv)]) ~> DimCustomer\nsource(output(\n\t\tBaseCustomerHierKey as long,\n\t\tCustomerNum as string,\n\t\tSiteZipClassCd as string,\n\t\tSiteGCityClassCd as string,\n\t\tSiteGCountryClassCd as string,\n\t\tSiteGAddress1ClassCd as string,\n\t\tSiteGAddress2ClassCd as string,\n\t\tSiteGStateCd as string,\n\t\tSiteGClassName as string,\n\t\tSiteGClass1Name as string,\n\t\tSite_Id as string,\n\t\tBaseCustHierarchyLevel1 as string,\n\t\tBaseCustHierarchyLevel1Desc as string,\n\t\tBaseCustHierarchyLevel2 as string,\n\t\tBaseCustHierarchyLevel2Desc as string,\n\t\tBaseCustHierarchyLevel3 as string,\n\t\tBaseCustHierarchyLevel3Desc as string,\n\t\tBaseCustHierarchyLevel4 as string,\n\t\tBaseCustHierarchyLevel4Desc as string,\n\t\tBaseCustHierarchyLevel5 as string,\n\t\tBaseCustHierarchyLevel5Desc as string,\n\t\tPublishDt as string,\n\t\tBaseHierType as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tSalesOrgCd as string,\n\t\tSiteIDName as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_dim_base_customer_hierarchy+$file_dim_base_customer_hierarchy+$file_extension_tsv)]) ~> DimBaseCustomerHierarchy\nsource(output(\n\t\tCustomerCd as string,\n\t\tEBSCustNum as string,\n\t\tBillbackCd as string,\n\t\tDistChannelCd as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_SALES_LKP_CUSTOMER_XREF+$file_SALES_LKP_CUSTOMER_XREF+$file_extension_tsv)]) ~> SalesLkpCustomerXref\nsource(output(\n\t\tDISequenceNum as string,\n\t\tDIOperationTypeCd as string,\n\t\tCancelDataRecInd as string,\n\t\tSalesDistDocumentNum as string,\n\t\tBillingDocumentPostingStatusCd as string,\n\t\tIntercompanyBillingTotalStatusCd as string,\n\t\tOrderBillingStatusCd as string,\n\t\tBillingStatusCd as string,\n\t\tOverallBillingBlockStatusCd as string,\n\t\tOverallProcessingStatusCd as string,\n\t\tOverallBlockedStatusCd as string,\n\t\tSDDocumentItemNum as string,\n\t\tChangesOnDt as string,\n\t\tCompanyCd as string,\n\t\tSalesDistrictCd as string,\n\t\tBillingTypeCd as string,\n\t\tBillingDt as string,\n\t\tBillingCatCd as string,\n\t\tLocalCurCd as string,\n\t\tCustGrpCd as string,\n\t\tSoldToPartyCd as string,\n\t\tPayerCd as string,\n\t\tFIPostingsExchangeRate as string,\n\t\tExchangeRateTypeCd as string,\n\t\tStatisticsCurCd as string,\n\t\tSDDocumentCatg1Cd as string,\n\t\tSalesOrgCd as string,\n\t\tDistChannelCd as string,\n\t\tSDDocumentCurCd as string,\n\t\tFiscalYear as string,\n\t\tPostingPeriodTm as string,\n\t\tTransferToAccountingStatusCd as string,\n\t\tAssignNumCd as string,\n\t\tPromotionCd as string,\n\t\tSalesDocumentNum as string,\n\t\tSalesDocumentItemNum as string,\n\t\tRebateBasis1Val as string,\n\t\tVolumeRebateGrpCd as string,\n\t\tGrossWeightQty as string,\n\t\tBillingItemDocumentCurGrossVal as string,\n\t\tApplicationComponentCd as string,\n\t\tSAPBWTransactionKeyCd as string,\n\t\tBatchNum as string,\n\t\tIntArticleNum as string,\n\t\tRecordCreatedDt as string,\n\t\tBillingPlanRuleCd as string,\n\t\tServicesRenderedDt as string,\n\t\tActualInvoicedQty as string,\n\t\tStockkeepingUnitBillingQty as string,\n\t\tWeightUnitMeas as string,\n\t\tSalesDealCd as string,\n\t\tControllingAreaCd as string,\n\t\tCostCenterCd as string,\n\t\tPriceDeterminationExchangeRate as string,\n\t\tTranslationDt as string,\n\t\tCustGrp1Cd as string,\n\t\tCustGrp2Cd as string,\n\t\tCustGrp3Cd as string,\n\t\tCustGrp4Cd as string,\n\t\tCustGrp5Cd as string,\n\t\tPricingProcedureConditionSubtotal1Amt as string,\n\t\tPricingProcedureConditionSubtotal2Amt as string,\n\t\tPricingProcedureConditionSubtotal3Amt as string,\n\t\tPricingProcedureConditionSubtotal4Amt as string,\n\t\tPricingProcedureConditionSubtotal5Amt as string,\n\t\tPricingProcedureConditionSubtotal6Amt as string,\n\t\tStorageLocationCd as string,\n\t\tMatMgmtRequiredQty as string,\n\t\tMatGrpCd as string,\n\t\tMatNum as string,\n\t\tMatEnteredNum as string,\n\t\tBaseUoMMeas as string,\n\t\tMatGrp1Cd as string,\n\t\tMatGrp2Cd as string,\n\t\tMatGrp3Cd as string,\n\t\tMatGrp4Cd as string,\n\t\tMatGrp5Cd as string,\n\t\tDocumentCurTaxAmt as string,\n\t\tBillingItemNetVal as string,\n\t\tNetWeightQty as string,\n\t\tBillToPartyCd as string,\n\t\tShipToPartyCd as string,\n\t\tItemTypeCd as string,\n\t\tProductHierarchyCd as string,\n\t\tCommisionGrpCd as string,\n\t\tPricingExchangeRateDt as string,\n\t\tSalesDocumentItemCatgCd as string,\n\t\tSalesEmpCd as string,\n\t\tCashDiscountEligibleAmt as string,\n\t\tBaseUoMScaleQty as string,\n\t\tOrderHeaderDivisionCd as string,\n\t\tDivisionCd as string,\n\t\tStatisticsDt as string,\n\t\tStatisticsExchangeRate as string,\n\t\tSalesQtyToSKUConversionDenominatorQty as string,\n\t\tSalesQtyToSKUConversionNumeratorQty as string,\n\t\tStatisticsUpdateDt as string,\n\t\tReferenceDocumentNum as string,\n\t\tReferenceItemNum as string,\n\t\tSalesOfficeCd as string,\n\t\tSalesGrpCd as string,\n\t\tVolumeUnitMeas as string,\n\t\tVolumeQty as string,\n\t\tSalesUnitCd as string,\n\t\tShippingPointCd as string,\n\t\tDocumentCurCostAmt as string,\n\t\tPlantCd as string,\n\t\tDocumentCurGrossVal as string,\n\t\tSalesTypeCd as string,\n\t\tTotalQty1 as string,\n\t\tStatisticsUOMTotalQty as string,\n\t\tTotalQty2 as string,\n\t\tStatisticsUoMBillingQty as string,\n\t\tDepartureCountryCd as string,\n\t\tOrderNum as string,\n\t\tOrderReasonTxt as string,\n\t\tSalesDocumentReferenceCd as string,\n\t\tSDDocumentCatgCd as string,\n\t\tAccountingInd as string,\n\t\tPlantCatgCd as string,\n\t\tItemCreditPriceVal as string,\n\t\tAgreedDeliveryTm as string,\n\t\tPurchasingGrpCd as string,\n\t\tPurchasingOrgCd as string,\n\t\tPurchasingAreaCd as string,\n\t\tObjectCreatedByName as string,\n\t\tEntryTm as string,\n\t\tFunctionalAreaCd as string,\n\t\tBillingPlanItemCd as string,\n\t\tEntryTm1 as string,\n\t\tVendorMatNum as string,\n\t\tAccountAssignmentGrpCd as string,\n\t\tSalesOrderDestinationCountryCd as string,\n\t\tMatTypeCd as string,\n\t\tOpenBillingDocumentCreditVal as string,\n\t\tTotalOpenBillingDocumentCreditVal as string,\n\t\tOpenBillingDocumentQty as string,\n\t\tOpenDeliveryCreditVal as string,\n\t\tTotalOpenDeliveryCreditVal as string,\n\t\tSoldToParty1Cd as string,\n\t\tProfitCenterCd as string,\n\t\tItemReturnedInd as string,\n\t\tBaseUoMSalesQty as string,\n\t\tGenerallyIncompleteInd as string,\n\t\tEBSAgreeNum as string,\n\t\tEBSAgreeTypCd as string,\n\t\tWorkBreakdownStructureElementCd as string,\n\t\tNumOfBillingItemNum as string,\n\t\tFiscalYearVariantCd as string,\n\t\tReferredSalesOrderItemCampaignCd as string,\n\t\tCustCd as string,\n\t\tPrecedingSalesDistDocumentCd as string,\n\t\tCust1Cd as string,\n\t\tPayer1Cd as string,\n\t\tSoldToParty2Num as string,\n\t\tBillToParty1Num as string,\n\t\tShipToParty1Num as string,\n\t\tODQChangeModeCd as string,\n\t\tODQEntityCntrCd as string,\n\t\tFileCreatedDtTm as string,\n\t\tFileName as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tIsReversedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_2LIS_13_VDITM+$file_2LIS_13_VDITM+$file_extension_tsv)]) ~> LIS13VDITM\nsource(output(\n\t\tDISequenceNum as string,\n\t\tDIOperationTypeCd as string,\n\t\tCompanyCd as string,\n\t\tFiscalYearDt as string,\n\t\tAccountingDocNum as string,\n\t\tLineItemNum as string,\n\t\tSubItemnum as string,\n\t\tFIItemStatusCd as string,\n\t\tCustomerNum as string,\n\t\tCreditControlAreaCd as string,\n\t\tDunninAreaMeas as string,\n\t\tAccountTypeCd as string,\n\t\tGLInd as string,\n\t\tAccountingDocTypeCd as string,\n\t\tPostingKeyCd as string,\n\t\tFiscalYearVariantCd as string,\n\t\tDocDt as string,\n\t\tDocPostingDt as string,\n\t\tAccDocEnterDt as string,\n\t\tClearDt as string,\n\t\tLastDunnDt as string,\n\t\tPaymentDueDt as string,\n\t\tTerms1CashDiscountDueDt as string,\n\t\tTerms2CashDiscountDueDt as string,\n\t\tBaselineDueDtForDueDtCalc as string,\n\t\tFirstCashDiscDaysTm as string,\n\t\tSecondCashDiscDaysTm as string,\n\t\tNetPayTermsTm as string,\n\t\tCashDisc1Pct as string,\n\t\tCashDisc2Pct as string,\n\t\tCountrCd as string,\n\t\tPaymentMethodCd as string,\n\t\tPaymentKeyTermsCd as string,\n\t\tPayBlockKeyCd as string,\n\t\tPaymentReasonCd as string,\n\t\tDunningBlockCd as string,\n\t\tDunningCd as string,\n\t\tDunningLevCd as string,\n\t\tLocalCurrCd as string,\n\t\tLocalCurrDebitAmt as string,\n\t\tLocalCurrCreditAmt as string,\n\t\tLocalCurrSignedAmt as string,\n\t\tLocalCurrCashDiscountAmt as string,\n\t\tCurrencyCd as string,\n\t\tDocCurrDebitAmt as string,\n\t\tDocCurrCreditAmt as string,\n\t\tSignedForeignAmt as string,\n\t\tEligibleDocDiscountAmt as string,\n\t\tDocDiscountAmt as string,\n\t\tChartOfAccountsCd as string,\n\t\tGLAccountCd as string,\n\t\tGLAccountNum as string,\n\t\tBranchAccountnum as string,\n\t\tClearingDocnum as string,\n\t\tReferDocNum as string,\n\t\tTxnInvoicenum as string,\n\t\tInvoiceFiscalyearNum as string,\n\t\tInvoicelineItemCd as string,\n\t\tSalesDistrDocNum as string,\n\t\tBusinessPartnerRefKey1Cd as string,\n\t\tBusinessPartnerRefKey2Cd as string,\n\t\tLineItemRefKeyCd as string,\n\t\tItemTxt as string,\n\t\tNegativePostingInd as string,\n\t\tDocArchiveInd as string,\n\t\tSplGLTransactiontypeCd as string,\n\t\tRecordModeCd as string,\n\t\tAssignmentNum as string,\n\t\tReferenceTxnAmt as string,\n\t\tReferenceKeyCd as string,\n\t\tDocstatusCd as string,\n\t\tLocalCurrAmt as string,\n\t\tLocalCurr2Amt as string,\n\t\tLocalCurr3Amt as string,\n\t\tFiscalYearNum as string,\n\t\tSecondCurrencyKeyCd as string,\n\t\tThirdCurrencyKeyCd as string,\n\t\tFiscalPeriodDt as string,\n\t\tWBSElementCd as string,\n\t\tDebitCreditInd as string,\n\t\tDocCurrencyAmt as string,\n\t\tProfitCenterCd as string,\n\t\tInternalDocHeaderKey as string,\n\t\tODQChangeModeCd as string,\n\t\tODQEntityCntrCd as string,\n\t\tFileCreatedDtTm as string,\n\t\tFileName as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tIsReversedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($path_0FI_AR_4+$file_0FI_AR_4+$file_extension_tsv)]) ~> FIAR4\nOToCAgingCntlDaily select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> cnt1\ncnt1 filter($SubjectAreacntl == $SubjectAreacntl && Status == 'S') ~> Filter1\nFilter1 aggregate(LastRunDate = max(toTimestamp(LastRunDate, 'MM/dd/yyyy HH:mm:ss'))) ~> maxdate\nFilter10 window(over(Payer),\n\tdesc(SoldTo, false),\n\tr = rowNumber()) ~> Window1\nWindow1 filter(r == 1) ~> Filter2\nFilter2 select(mapColumn(\n\t\tPayer,\n\t\tSoldTo\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SoldToPayerLookup1\nBillingSoldTolookup window(over(BillingDocNum),\n\tdesc(SoldTo, false),\n\tr = rowNumber()) ~> Window2\nWindow2 filter(r == 1) ~> Filter3\nFilter3 select(mapColumn(\n\t\tBillingDocNum,\n\t\tSoldTo\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> BillingSoldTolookup1\nDimCustomer window(over(CustomerNum),\n\tdesc(CustomerKey, false),\n\tr = rowNumber()) ~> Window3\nWindow3 filter(r == 1) ~> Filter4\nFilter4 select(mapColumn(\n\t\tCustomerKey,\n\t\tCustomerNum,\n\t\tDunningProcedureCd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Customer\nDimBaseCustomerHierarchy window(over(CustomerNum),\n\tdesc(BaseCustomerHierKey, false),\n\tr = rowNumber()) ~> Window4\nWindow4 filter(r == 1) ~> Filter5\nFilter5 select(mapColumn(\n\t\tBaseCustomerHierKey,\n\t\tCustomerNum\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Customerhier\nSalesLkpCustomerXref window(over(EBSCustNum),\n\tdesc(toTimestamp(LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'), false),\n\tr = rowNumber()) ~> Window5\nWindow5 filter(r == 1) ~> Filter6\nFilter6 select(mapColumn(\n\t\tLegacyCustomerCd = CustomerCd,\n\t\tEBSCustNum\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Customerxref\nLIS13VDITM window(over(SalesDistDocumentNum),\n\tdesc(toTimestamp(LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'), false),\n\tr = rowNumber()) ~> Window6\nWindow6 filter(r == 1) ~> Filter7\nFilter7 select(mapColumn(\n\t\tSalesDistDocumentNum,\n\t\tBillToParty1Num\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> BillingDocumentItemData\nFIAR4, maxdate join(1 == 1 || DISequenceNum == 'Dummy' || LastRunDate == toTimestamp('01/01/9999 01:01:01'),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> CrossJoinMaxDate\nCrossJoinMaxDate filter(toTimestamp(LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss') > LastRunDate) ~> Filter8\nFilter8 derive(CompanyCd = trim(CompanyCd),\n\t\tPayerCustomerNum = trim(CustomerNum),\n\t\tDocPostingDt = case(\n    isNull(DocPostingDt), '19000101', DocPostingDt\n),\n\t\tPaymentDueDt = case(\n    isNull(PaymentDueDt), '19000101', PaymentDueDt\n),\n\t\tLocalCurrSignedAmt = toDouble(case(\n    isNull(LocalCurrSignedAmt), '0', LocalCurrSignedAmt\n)),\n\t\tBranchAccountnum = toString(\n    case(\n        isNull(trim(BranchAccountnum)), '', trim(BranchAccountnum)\n    )\n),\n\t\tBillingDoc = case(\n    toLong(\n        case(\n            regexMatch(trim(AccountingDocNum), '^[0-9]+$') && trim(AccountingDocNum) != '',\n            trim(AccountingDocNum),\n            '0'\n        )) >= toLong('6000000000')\n        && \n     toLong(\n        case(\n            regexMatch(trim(AccountingDocNum), '^[0-9]+$') && trim(AccountingDocNum) != '',\n            trim(AccountingDocNum),\n            '0'\n        )) <= toLong('7999999999')\n        &&\nAccountingDocTypeCd != 'U1' && AccountingDocTypeCd != 'DZ',\ntrim(AccountingDocNum),\n\ncase(       \n    toLong(\n        case(\n            regexMatch(trim(AssignmentNum), '^[0-9]+$') && trim(AssignmentNum) != '',\n            trim(AssignmentNum),\n            '0'\n        )) >= toLong('6000000000') \n        && \n     toLong(\n        case(\n            regexMatch(trim(AssignmentNum), '^[0-9]+$') && trim(AssignmentNum) != '',\n            trim(AssignmentNum),\n            '0'\n        )) <= toLong('7999999999')\n        &&\nAccountingDocTypeCd != 'U1',\ntrim(AssignmentNum),\n\ncase(\n    AccountingDocTypeCd == 'U1', trim(SalesDistrDocNum),\n\n\ncase(\n    AccountingDocTypeCd != 'RV' && AccountingDocTypeCd != 'U1' && AccountingDocTypeCd != 'R1'\n    &&\n    toLong(\n        case(\n            regexMatch(trim(TxnInvoicenum), '^[0-9]+$') && trim(TxnInvoicenum) != '',\n            trim(TxnInvoicenum),\n            '0'\n        )) >=  toLong('6000000000') \n   &&\n    toLong(\n        case(\n            regexMatch(trim(TxnInvoicenum), '^[0-9]+$') && trim(TxnInvoicenum) != '',\n            trim(TxnInvoicenum),\n            '0'\n        )) <=  toLong('7999999999'), \n        trim(TxnInvoicenum),\n        trim(AccountingDocNum)\n))))) ~> DerivedColumn1\nFilter11 select(mapColumn(\n\t\tDISequenceNum,\n\t\tDIOperationTypeCd,\n\t\tBillingDoc,\n\t\tCompanyCd,\n\t\tFiscalYearDt,\n\t\tAccountingDocNum,\n\t\tLineItemNum,\n\t\tSubItemnum,\n\t\tFIItemStatusCd,\n\t\tPayerCustomerNum,\n\t\tCreditControlAreaCd,\n\t\tDunninAreaMeas,\n\t\tAccountTypeCd,\n\t\tGLInd,\n\t\tAccountingDocTypeCd,\n\t\tPostingKeyCd,\n\t\tFiscalYearVariantCd,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tAccDocEnterDt,\n\t\tClearDt,\n\t\tLastDunnDt,\n\t\tPaymentDueDt,\n\t\tTerms1CashDiscountDueDt,\n\t\tTerms2CashDiscountDueDt,\n\t\tBaselineDueDtForDueDtCalc,\n\t\tFirstCashDiscDaysTm,\n\t\tSecondCashDiscDaysTm,\n\t\tNetPayTermsTm,\n\t\tCashDisc1Pct,\n\t\tCashDisc2Pct,\n\t\tCountrCd,\n\t\tPaymentMethodCd,\n\t\tPaymentKeyTermsCd,\n\t\tPayBlockKeyCd,\n\t\tPaymentReasonCd,\n\t\tDunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tLocalCurrCd,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrSignedAmt,\n\t\tLocalCurrCashDiscountAmt,\n\t\tCurrencyCd,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrCreditAmt,\n\t\tSignedForeignAmt,\n\t\tEligibleDocDiscountAmt,\n\t\tDocDiscountAmt,\n\t\tChartOfAccountsCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tBranchAccountnum,\n\t\tClearingDocnum,\n\t\tReferDocNum,\n\t\tTxnInvoicenum,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tSalesDistrDocNum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tLineItemRefKeyCd,\n\t\tItemTxt,\n\t\tNegativePostingInd,\n\t\tDocArchiveInd,\n\t\tSplGLTransactiontypeCd,\n\t\tRecordModeCd,\n\t\tAssignmentNum,\n\t\tReferenceTxnAmt,\n\t\tReferenceKeyCd,\n\t\tDocstatusCd,\n\t\tLocalCurrAmt,\n\t\tLocalCurr2Amt,\n\t\tLocalCurr3Amt,\n\t\tFiscalYearNum,\n\t\tSecondCurrencyKeyCd,\n\t\tThirdCurrencyKeyCd,\n\t\tFiscalPeriodDt,\n\t\tWBSElementCd,\n\t\tDebitCreditInd,\n\t\tDocCurrencyAmt,\n\t\tProfitCenterCd,\n\t\tInternalDocHeaderKey,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tIsReversedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AgingExplExtract1\nAgingExplExtract1, BillingSoldTolookup1 join(BillingDoc === BillingDocNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinbillingsoldto\nSelect4, SoldToPayerLookup1 join(PayerCustomerNum === Payer,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinsoldtopayer\nSelect5, BillingDocumentItemDataU1 join(SalesDistrDocNum === SalesDistDocumentNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinBillingDocumentItemDataU1\nSelect1, BillingDocumentItemDataNonU1 join(BillingDoc === BillingDocumentItemDataNonU1@SalesDistDocumentNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinBillingDocumentItemDataNonU1\nLeftJoinBillingDocumentItemDataU1 select(mapColumn(\n\t\tDISequenceNum,\n\t\tDIOperationTypeCd,\n\t\tBillingDoc,\n\t\tCompanyCd,\n\t\tFiscalYearDt,\n\t\tAccountingDocNum,\n\t\tLineItemNum,\n\t\tSubItemnum,\n\t\tFIItemStatusCd,\n\t\tPayerCustomerNum,\n\t\tCreditControlAreaCd,\n\t\tDunninAreaMeas,\n\t\tAccountTypeCd,\n\t\tGLInd,\n\t\tAccountingDocTypeCd,\n\t\tPostingKeyCd,\n\t\tFiscalYearVariantCd,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tAccDocEnterDt,\n\t\tClearDt,\n\t\tLastDunnDt,\n\t\tPaymentDueDt,\n\t\tTerms1CashDiscountDueDt,\n\t\tTerms2CashDiscountDueDt,\n\t\tBaselineDueDtForDueDtCalc,\n\t\tFirstCashDiscDaysTm,\n\t\tSecondCashDiscDaysTm,\n\t\tNetPayTermsTm,\n\t\tCashDisc1Pct,\n\t\tCashDisc2Pct,\n\t\tCountrCd,\n\t\tPaymentMethodCd,\n\t\tPaymentKeyTermsCd,\n\t\tPayBlockKeyCd,\n\t\tPaymentReasonCd,\n\t\tDunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tLocalCurrCd,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrSignedAmt,\n\t\tLocalCurrCashDiscountAmt,\n\t\tCurrencyCd,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrCreditAmt,\n\t\tSignedForeignAmt,\n\t\tEligibleDocDiscountAmt,\n\t\tDocDiscountAmt,\n\t\tChartOfAccountsCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tBranchAccountnum,\n\t\tClearingDocnum,\n\t\tReferDocNum,\n\t\tTxnInvoicenum,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tSalesDistrDocNum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tLineItemRefKeyCd,\n\t\tItemTxt,\n\t\tNegativePostingInd,\n\t\tDocArchiveInd,\n\t\tSplGLTransactiontypeCd,\n\t\tRecordModeCd,\n\t\tAssignmentNum,\n\t\tReferenceTxnAmt,\n\t\tReferenceKeyCd,\n\t\tDocstatusCd,\n\t\tLocalCurrAmt,\n\t\tLocalCurr2Amt,\n\t\tLocalCurr3Amt,\n\t\tFiscalYearNum,\n\t\tSecondCurrencyKeyCd,\n\t\tThirdCurrencyKeyCd,\n\t\tFiscalPeriodDt,\n\t\tWBSElementCd,\n\t\tDebitCreditInd,\n\t\tDocCurrencyAmt,\n\t\tProfitCenterCd,\n\t\tInternalDocHeaderKey,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tIsReversedInd,\n\t\tBillingDocNum,\n\t\tbilling_soldto_SoldTo,\n\t\tPayer,\n\t\tsoldto_payer_SoldTo,\n\t\tSalesDistDocumentNum,\n\t\tBillToParty1Num\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nLeftJoinBillingDocumentItemDataNonU1 derive(PastDue1To30DaysAmt = case(\n    toDate(PaymentDueDt,'yyyyMMdd') >=subDays(currentDate(),30) && toDate(PaymentDueDt,'yyyyMMdd') <=subDays(currentDate(),1),\n    LocalCurrSignedAmt, toDouble('0')\n),\n\t\tPastDue31To60DaysAmt = case(\n    toDate(PaymentDueDt,'yyyyMMdd') >=subDays(currentDate(),60) && toDate(PaymentDueDt,'yyyyMMdd') <=subDays(currentDate(),31),\n    LocalCurrSignedAmt, toDouble('0')\n),\n\t\tPastDue61To90DaysAmt = case(\n    toDate(PaymentDueDt,'yyyyMMdd') >=subDays(currentDate(),90) && toDate(PaymentDueDt,'yyyyMMdd') <=subDays(currentDate(),61),\n    LocalCurrSignedAmt, toDouble('0')\n),\n\t\tPastDue91PlusDaysAmt = case(\n toDate(PaymentDueDt,'yyyyMMdd') <=subDays(currentDate(),91),\n    LocalCurrSignedAmt, toDouble('0')\n),\n\t\tCurrentARAmt = case(\n    toDate(PaymentDueDt,'yyyyMMdd') >=currentDate(),\n    LocalCurrSignedAmt, toDouble('0')\n),\n\t\tAgingDate = case(\n    toTimestamp(toString(currentTimestamp(),'HH:mm:ss')) >= toTimestamp('00:00:00','HH:mm:ss')\n    &&\n    toTimestamp(toString(currentTimestamp(), 'HH:mm:ss')) <= toTimestamp('05:00:00','HH:mm:ss'),\n    toString(currentTimestamp(), 'MM/dd/yyyy'),\n    toString(subDays(currentTimestamp(),1),'MM/dd/yyyy') \n),\n\t\tURLTxt = '',\n\t\tOwner = '',\n\t\tBillToCustomer = case(\n    AccountingDocTypeCd == 'U1', Select1@BillToParty1Num,\ntoString(case(\n    AccountingDocTypeCd != 'U1' && !isNull(BillingDoc) && BillingDoc != '', BillingDocumentItemDataNonU1@BillToParty1Num,\n    toString(null())\n))\n),\n\t\tSoldToCustomer = case(\n    BranchAccountnum != '', BranchAccountnum,\ncase(\n    BranchAccountnum == '' && BillingDoc != '', billing_soldto_SoldTo,\ncase(BranchAccountnum == '' && BillingDoc == '', soldto_payer_SoldTo,\n    ''\n)\n)\n)) ~> DerivedColumn2\nDerivedColumn2 select(mapColumn(\n\t\tAccDocEnterDt,\n\t\tAccountingDocNum,\n\t\tAccountingDocTypeCd,\n\t\tAccountTypeCd,\n\t\tAgingDate,\n\t\tAssignmentNum,\n\t\tBaselineDueDtForDueDtCalc,\n\t\tBillingDoc,\n\t\tBillToCustomer,\n\t\tBranchAccountnum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tCashDisc1Pct,\n\t\tCashDisc2Pct,\n\t\tChartOfAccountsCd,\n\t\tClearDt,\n\t\tClearingDocnum,\n\t\tCompanyCd,\n\t\tCountrCd,\n\t\tCreatedDtTm,\n\t\tCreditControlAreaCd,\n\t\tCurrencyCd,\n\t\tCurrentARAmt,\n\t\tDebitCreditInd,\n\t\tDIOperationTypeCd,\n\t\tDISequenceNum,\n\t\tDocArchiveInd,\n\t\tDocCurrCreditAmt,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrencyAmt,\n\t\tDocDiscountAmt,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tDocstatusCd,\n\t\tDunninAreaMeas,\n\t\tDunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tEligibleDocDiscountAmt,\n\t\tFIItemStatusCd,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tFirstCashDiscDaysTm,\n\t\tFiscalPeriodDt,\n\t\tFiscalYearDt,\n\t\tFiscalYearNum,\n\t\tFiscalYearVariantCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tGLInd,\n\t\tInternalDocHeaderKey,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tIsReversedInd,\n\t\tItemTxt,\n\t\tJobId,\n\t\tLastDunnDt,\n\t\tLastUpdtDtTm,\n\t\tLineItemNum,\n\t\tLineItemRefKeyCd,\n\t\tLocalCurr2Amt,\n\t\tLocalCurr3Amt,\n\t\tLocalCurrAmt,\n\t\tLocalCurrCashDiscountAmt,\n\t\tLocalCurrCd,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrSignedAmt,\n\t\tNegativePostingInd,\n\t\tNetPayTermsTm,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tOwner,\n\t\tPastDue1To30DaysAmt,\n\t\tPastDue31To60DaysAmt,\n\t\tPastDue61To90DaysAmt,\n\t\tPastDue91PlusDaysAmt,\n\t\tPayBlockKeyCd,\n\t\tPayerCustomerNum,\n\t\tPaymentDueDt,\n\t\tPaymentKeyTermsCd,\n\t\tPaymentMethodCd,\n\t\tPaymentReasonCd,\n\t\tPostingKeyCd,\n\t\tProfitCenterCd,\n\t\tRecordModeCd,\n\t\tReferDocNum,\n\t\tReferenceKeyCd,\n\t\tReferenceTxnAmt,\n\t\tSalesDistDocumentNum = Select1@SalesDistDocumentNum,\n\t\tSecondCashDiscDaysTm,\n\t\tSecondCurrencyKeyCd,\n\t\tSignedForeignAmt,\n\t\tSoldToCustomer,\n\t\tSplGLTransactiontypeCd,\n\t\tSubItemnum,\n\t\tTerms1CashDiscountDueDt,\n\t\tTerms2CashDiscountDueDt,\n\t\tThirdCurrencyKeyCd,\n\t\tTxnInvoicenum,\n\t\tURLTxt,\n\t\tWBSElementCd,\n\t\tSalesDistrDocNum\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> LogicPopulation\nLogicPopulation, soldtocust join(SoldToCustomer === CustomerNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinsoldtocust\nLeftJoinsoldtocust, payercust join(PayerCustomerNum === payercust@CustomerNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinpayercust\nLeftJoinpayercust, soldtocusthier join(SoldToCustomer === soldtocusthier@CustomerNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinsoldtocusthier\nLeftJoinsoldtocusthier, payercusthier join(PayerCustomerNum === payercusthier@CustomerNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinpayercusthier\nLeftJoinpayercusthier, Customerxref join(SoldToCustomer === EBSCustNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinCustomerxref\nLeftJoinCustomerxref, BillTo join(BillToCustomer === BillTo@CustomerNum,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinBillTo\nLeftJoinBillTo derive(SoldToCustomerKey = case(\n    isNull(SoldToCustomer) || SoldToCustomer == '', toLong(-1),\ncase(\n    isNull(soldtocust@CustomerKey) || toString(soldtocust@CustomerKey) == '', toLong(-2),\n    soldtocust@CustomerKey\n)\n),\n\t\tPayerCustomerKey = case(\n    isNull(PayerCustomerNum) || PayerCustomerNum == '', toLong(-1),\ncase(\n    isNull(payercust@CustomerKey) || toString(payercust@CustomerKey) == '', toLong(-2),\n    payercust@CustomerKey\n)\n),\n\t\tBillToCustomerKey = case(\n    isNull(BillToCustomer) || BillToCustomer == '', toLong(-1),\ncase(\n    isNull(BillTo@CustomerKey) || toString(BillTo@CustomerKey) == '', toLong(-2),\n    BillTo@CustomerKey\n)\n),\n\t\tSoldToCustomerHierarchyKey = case(\n    isNull(SoldToCustomer) || SoldToCustomer == '', toLong(-1),\ncase(\n    isNull(soldtocusthier@BaseCustomerHierKey) || toString(soldtocusthier@BaseCustomerHierKey) == '', toLong(-2),\n    soldtocusthier@BaseCustomerHierKey\n)\n),\n\t\tPayerCustomerHierarchyKey = case(\n    isNull(PayerCustomerNum) || PayerCustomerNum == '',toLong(-1),\ncase(\n    isNull(payercusthier@BaseCustomerHierKey) || toString(payercusthier@BaseCustomerHierKey) == '', toLong(-2),\n    payercusthier@BaseCustomerHierKey\n)\n),\n\t\tCAMAlignmentKey = case(\n    isNull(SoldToCustomer) || SoldToCustomer == '', '-1',\n    SoldToCustomer\n),\n\t\tCurrentAlignmentKey = case(\n    isNull(SoldToCustomer) || SoldToCustomer == '', '-1',\n    SoldToCustomer\n),\n\t\tPreviousAlignmentKey = case(\n    isNull(SoldToCustomer) || SoldToCustomer == '', '-1',\n    SoldToCustomer\n),\n\t\tAgreementKey = case(\n    isNull(SoldToCustomer) || SoldToCustomer == '', '-1',\n    SoldToCustomer\n),\n\t\tTMvsCAMOwnership = case(\n    isNull(soldtocust@DunningProcedureCd) || soldtocust@DunningProcedureCd == '', 'CAM Ownership', 'TM Ownership'\n),\n\t\tLocalCurrSignedAmt = toString(LocalCurrSignedAmt),\n\t\tLegacySoldToCustomer = case(\n    AccountingDocTypeCd == 'U1', LegacyCustomerCd, ''\n),\n\t\tPastDue1To30DaysAmt = toString(PastDue1To30DaysAmt),\n\t\tPastDue31To60DaysAmt = toString(PastDue31To60DaysAmt),\n\t\tPastDue61To90DaysAmt = toString(PastDue61To90DaysAmt),\n\t\tPastDue91PlusDaysAmt = toString(PastDue91PlusDaysAmt),\n\t\tCurrentARAmt = toString(CurrentARAmt),\n\t\tPastDueARAmt = toString(PastDue1To30DaysAmt+PastDue31To60DaysAmt+PastDue61To90DaysAmt+PastDue91PlusDaysAmt),\n\t\tTotalARAmt = toString(PastDue1To30DaysAmt+PastDue31To60DaysAmt+PastDue61To90DaysAmt+PastDue91PlusDaysAmt+CurrentARAmt),\n\t\tCreatedDttm = toString(currentTimestamp(), 'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDttm = toString(currentTimestamp(), 'MM/dd/yyyy HH:mm:ss'),\n\t\tJobId = $JobId) ~> DerivedColumn3\nDerivedColumn3 select(mapColumn(\n\t\tAccDocEnterDt,\n\t\tAccountingDocNum,\n\t\tAccountingDocTypeCd,\n\t\tAccountTypeCd,\n\t\tAgingDate,\n\t\tAgreementKey,\n\t\tAssignmentNum,\n\t\tBaselineDueDtForDueDtCalc,\n\t\tBillingDoc,\n\t\tBillToCustomer,\n\t\tBillToCustomerKey,\n\t\tBranchAccountnum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tCAMAlignmentKey,\n\t\tCashDisc1Pct,\n\t\tCashDisc2Pct,\n\t\tChartOfAccountsCd,\n\t\tClearDt,\n\t\tClearingDocnum,\n\t\tCompanyCd,\n\t\tCountrCd,\n\t\tCreatedDttm = DerivedColumn3@CreatedDttm,\n\t\tCreditControlAreaCd,\n\t\tCurrencyCd,\n\t\tCurrentAlignmentKey,\n\t\tCurrentARAmt,\n\t\tDebitCreditInd,\n\t\tDIOperationTypeCd,\n\t\tDISequenceNum,\n\t\tDocArchiveInd,\n\t\tDocCurrCreditAmt,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrencyAmt,\n\t\tDocDiscountAmt,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tDocstatusCd,\n\t\tDunninAreaMeas,\n\t\tDunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tDunningProcedureCd = payercust@DunningProcedureCd,\n\t\tEligibleDocDiscountAmt,\n\t\tFIItemStatusCd,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tFirstCashDiscDaysTm,\n\t\tFiscalPeriodDt,\n\t\tFiscalYearDt,\n\t\tFiscalYearNum,\n\t\tFiscalYearVariantCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tGLInd,\n\t\tInternalDocHeaderKey,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tIsReversedInd,\n\t\tItemTxt,\n\t\tJobId,\n\t\tLastDunnDt,\n\t\tLastUpdtDttm = DerivedColumn3@LastUpdtDttm,\n\t\tLegacySoldToCustomer,\n\t\tLineItemNum,\n\t\tLineItemRefKeyCd,\n\t\tLocalCurr2Amt,\n\t\tLocalCurr3Amt,\n\t\tLocalCurrAmt,\n\t\tLocalCurrCashDiscountAmt,\n\t\tLocalCurrCd,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrSignedAmt,\n\t\tNegativePostingInd,\n\t\tNetPayTermsTm,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tOwner,\n\t\tPastDue1To30DaysAmt,\n\t\tPastDue31To60DaysAmt,\n\t\tPastDue61To90DaysAmt,\n\t\tPastDue91PlusDaysAmt,\n\t\tPastDueARAmt,\n\t\tPayBlockKeyCd,\n\t\tPayerCustomerHierarchyKey,\n\t\tPayerCustomerKey,\n\t\tPayerCustomerNum,\n\t\tPaymentDueDt,\n\t\tPaymentKeyTermsCd,\n\t\tPaymentMethodCd,\n\t\tPaymentReasonCd,\n\t\tPostingKeyCd,\n\t\tPreviousAlignmentKey,\n\t\tProfitCenterCd,\n\t\tRecordModeCd,\n\t\tReferDocNum,\n\t\tReferenceKeyCd,\n\t\tReferenceTxnAmt,\n\t\tSalesDistDocumentNum,\n\t\tSecondCashDiscDaysTm,\n\t\tSecondCurrencyKeyCd,\n\t\tSignedForeignAmt,\n\t\tSoldToCustomer,\n\t\tSoldToCustomerHierarchyKey,\n\t\tSoldToCustomerKey,\n\t\tSplGLTransactiontypeCd,\n\t\tSubItemnum,\n\t\tTerms1CashDiscountDueDt,\n\t\tTerms2CashDiscountDueDt,\n\t\tThirdCurrencyKeyCd,\n\t\tTMvsCAMOwnership,\n\t\tTotalARAmt,\n\t\tTxnInvoicenum,\n\t\tURLTxt,\n\t\tWBSElementCd,\n\t\tSalesDistrDocNum\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FinalDailySet\nFinalDailySet derive(InvoiceNum = case(\n    AccountingDocTypeCd == 'U1', trim(ReferDocNum), trim(AccountingDocNum)\n)) ~> DerivedColumn4\nDerivedColumn4 select(mapColumn(\n\t\tSoldToCustomer,\n\t\tDunningProcedureCd,\n\t\tLegacySoldToCustomer,\n\t\tURLTxt,\n\t\tOwner,\n\t\tBillToCustomer,\n\t\tJobId,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tCreatedDttm,\n\t\tLastUpdtDttm,\n\t\tDISequenceNum,\n\t\tDIOperationTypeCd,\n\t\tInvoiceNum,\n\t\tAgingDate,\n\t\tSoldToCustomerKey,\n\t\tPayerCustomerKey,\n\t\tBillToCustomerKey,\n\t\tSoldToCustomerHierarchyKey,\n\t\tPayerCustomerHierarchyKey,\n\t\tCAMAlignmentKey,\n\t\tCurrentAlignmentKey,\n\t\tPreviousAlignmentKey,\n\t\tAgreementKey,\n\t\tCompanyCd,\n\t\tFiscalYearDt,\n\t\tAccountingDocNum,\n\t\tLineItemNum,\n\t\tSubItemnum,\n\t\tFIItemStatusCd,\n\t\tPayer = PayerCustomerNum,\n\t\tTMvsCAMOwnership,\n\t\tCreditControlAreaCd,\n\t\tDunninAreaMeas,\n\t\tAccountTypeCd,\n\t\tGLInd,\n\t\tAccountingDocTypeCd,\n\t\tPostingKeyCd,\n\t\tFiscalVariantCd = FiscalYearVariantCd,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tAccDocEnterDt,\n\t\tClearDt,\n\t\tLastDunnDt,\n\t\tNetDueDt = PaymentDueDt,\n\t\tPaymentDtToAvailDiscountI = Terms1CashDiscountDueDt,\n\t\tPaymentDtToAvailDiscountII = Terms2CashDiscountDueDt,\n\t\tBaselineDtForDueDtCalculation = BaselineDueDtForDueDtCalc,\n\t\tDaysToPayWithinToAvailDiscountI = FirstCashDiscDaysTm,\n\t\tDaysToPayWithinToAvailDiscountII = SecondCashDiscDaysTm,\n\t\tNetPayTermsTm,\n\t\tCashDiscountPctI = CashDisc1Pct,\n\t\tCashDiscountPctII = CashDisc2Pct,\n\t\tCountrCd,\n\t\tPaymentMethodCd,\n\t\tPaymentTermsCode = PaymentKeyTermsCd,\n\t\tPaymentBlockKey = PayBlockKeyCd,\n\t\tReasonCodes = PaymentReasonCd,\n\t\tDunningBlock = DunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tLocalCurrCd,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrSignedAmt,\n\t\tDiscountTakenAndHonoured = LocalCurrCashDiscountAmt,\n\t\tCurrencyCd,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrCreditAmt,\n\t\tSignedForeignAmt,\n\t\tEligibleDocDiscountAmt,\n\t\tDocDiscountAmt,\n\t\tChartOfAccountsCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tBranchAccountnum,\n\t\tClearingDocnum,\n\t\tReferDocNum,\n\t\tTxnInvoicenum,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tSalesDistrDocNum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tLineItemRefKeyCd,\n\t\tItemTxt,\n\t\tNegativePostingInd,\n\t\tDocArchiveInd,\n\t\tSplGLTransactiontypeCd,\n\t\tRecordModeCd,\n\t\tAssignmentNum,\n\t\tReferenceTxnAmt,\n\t\tReferenceKeyCd,\n\t\tDocstatusCd,\n\t\tLocalCurrAmt,\n\t\tAmountInSecondLocalCurrency = LocalCurr2Amt,\n\t\tAmountInThirdLocalCurrency = LocalCurr3Amt,\n\t\tFiscalYearNum,\n\t\tSecondCurrencyKeyCd,\n\t\tThirdCurrencyKeyCd,\n\t\tFiscalPeriodDt,\n\t\tWBSElementCd,\n\t\tDebitCreditInd,\n\t\tDocCurrencyAmt,\n\t\tProfitCenterCd,\n\t\tInternalDocHeaderKey,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tIsReversedInd,\n\t\tBillingDoc\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FinalDailySetWithoutColumn\nFinalDailySetWithoutColumn derive(forencryption = case(\n    AccountingDocTypeCd == 'U1' && like(CompanyCd, 'US%'),\n    concat('custnbr=29a8dc05-dd09-4a14-975c-ff29f0d418f0&method=getMyBills&acctnumber=', iifNull(SoldToCustomer,''), '&invoice0=009',substring(DocDt,5,2),substring(DocDt,1,4),InvoiceNum),\ncase(\n    AccountingDocTypeCd != 'U1' && like(CompanyCd, 'US%'),\n    concat('custnbr=29a8dc05-dd09-4a14-975c-ff29f0d418f0&method=getMyBills&acctnumber=',iifNull(BillToCustomer,''), '&invoice0=', InvoiceNum), \n\ncase(\n    AccountingDocTypeCd != 'U1' && like(CompanyCd, 'CA%'),\n    concat('custnbr=29a8dc05-dd09-4a14-975c-ff29f0d418f0&method=getMyBills&acctnumber=',iifNull(Payer,''), '&invoice0=', InvoiceNum), ''\n)\n)\n)) ~> FinalDailySetWithoutColumn1\nFinalDailySetWithoutColumn1 derive(URLTxt = concat('https://secure.billtrust.com/xmlwebservices/webServiceDispatch.php?custnbr=29a8dc05-dd09-4a14-975c-ff29f0d418f0&p=','|~|', case(isNull(forencryption),'',forencryption)),\n\t\tAgingDate = toDate(AgingDate,'MM/dd/yyyy')) ~> FinalDailySetWithoutColumn2\ncnt1 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getoldcntlvalue\ncnt1 derive(LastRunDate = toString(currentTimestamp(), 'MM/dd/yyyy HH:mm:ss'),\n\t\tStatus = 'S',\n\t\tSubjectArea = $SubjectAreacntl) ~> DerivedColumn5\nDerivedColumn5 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tDummy = max(1)) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, getoldcntlvalue union(byName: true)~> Union1\nLeftJoinbillingsoldto select(mapColumn(\n\t\tDISequenceNum,\n\t\tDIOperationTypeCd,\n\t\tBillingDoc,\n\t\tCompanyCd,\n\t\tFiscalYearDt,\n\t\tAccountingDocNum,\n\t\tLineItemNum,\n\t\tSubItemnum,\n\t\tFIItemStatusCd,\n\t\tPayerCustomerNum,\n\t\tCreditControlAreaCd,\n\t\tDunninAreaMeas,\n\t\tAccountTypeCd,\n\t\tGLInd,\n\t\tAccountingDocTypeCd,\n\t\tPostingKeyCd,\n\t\tFiscalYearVariantCd,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tAccDocEnterDt,\n\t\tClearDt,\n\t\tLastDunnDt,\n\t\tPaymentDueDt,\n\t\tTerms1CashDiscountDueDt,\n\t\tTerms2CashDiscountDueDt,\n\t\tBaselineDueDtForDueDtCalc,\n\t\tFirstCashDiscDaysTm,\n\t\tSecondCashDiscDaysTm,\n\t\tNetPayTermsTm,\n\t\tCashDisc1Pct,\n\t\tCashDisc2Pct,\n\t\tCountrCd,\n\t\tPaymentMethodCd,\n\t\tPaymentKeyTermsCd,\n\t\tPayBlockKeyCd,\n\t\tPaymentReasonCd,\n\t\tDunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tLocalCurrCd,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrSignedAmt,\n\t\tLocalCurrCashDiscountAmt,\n\t\tCurrencyCd,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrCreditAmt,\n\t\tSignedForeignAmt,\n\t\tEligibleDocDiscountAmt,\n\t\tDocDiscountAmt,\n\t\tChartOfAccountsCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tBranchAccountnum,\n\t\tClearingDocnum,\n\t\tReferDocNum,\n\t\tTxnInvoicenum,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tSalesDistrDocNum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tLineItemRefKeyCd,\n\t\tItemTxt,\n\t\tNegativePostingInd,\n\t\tDocArchiveInd,\n\t\tSplGLTransactiontypeCd,\n\t\tRecordModeCd,\n\t\tAssignmentNum,\n\t\tReferenceTxnAmt,\n\t\tReferenceKeyCd,\n\t\tDocstatusCd,\n\t\tLocalCurrAmt,\n\t\tLocalCurr2Amt,\n\t\tLocalCurr3Amt,\n\t\tFiscalYearNum,\n\t\tSecondCurrencyKeyCd,\n\t\tThirdCurrencyKeyCd,\n\t\tFiscalPeriodDt,\n\t\tWBSElementCd,\n\t\tDebitCreditInd,\n\t\tDocCurrencyAmt,\n\t\tProfitCenterCd,\n\t\tInternalDocHeaderKey,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tIsReversedInd,\n\t\tBillingDocNum,\n\t\tSoldTo\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Select4\nLeftJoinsoldtopayer select(mapColumn(\n\t\tDISequenceNum,\n\t\tDIOperationTypeCd,\n\t\tBillingDoc,\n\t\tCompanyCd,\n\t\tFiscalYearDt,\n\t\tAccountingDocNum,\n\t\tLineItemNum,\n\t\tSubItemnum,\n\t\tFIItemStatusCd,\n\t\tPayerCustomerNum,\n\t\tCreditControlAreaCd,\n\t\tDunninAreaMeas,\n\t\tAccountTypeCd,\n\t\tGLInd,\n\t\tAccountingDocTypeCd,\n\t\tPostingKeyCd,\n\t\tFiscalYearVariantCd,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tAccDocEnterDt,\n\t\tClearDt,\n\t\tLastDunnDt,\n\t\tPaymentDueDt,\n\t\tTerms1CashDiscountDueDt,\n\t\tTerms2CashDiscountDueDt,\n\t\tBaselineDueDtForDueDtCalc,\n\t\tFirstCashDiscDaysTm,\n\t\tSecondCashDiscDaysTm,\n\t\tNetPayTermsTm,\n\t\tCashDisc1Pct,\n\t\tCashDisc2Pct,\n\t\tCountrCd,\n\t\tPaymentMethodCd,\n\t\tPaymentKeyTermsCd,\n\t\tPayBlockKeyCd,\n\t\tPaymentReasonCd,\n\t\tDunningBlockCd,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tLocalCurrCd,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrSignedAmt,\n\t\tLocalCurrCashDiscountAmt,\n\t\tCurrencyCd,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrCreditAmt,\n\t\tSignedForeignAmt,\n\t\tEligibleDocDiscountAmt,\n\t\tDocDiscountAmt,\n\t\tChartOfAccountsCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tBranchAccountnum,\n\t\tClearingDocnum,\n\t\tReferDocNum,\n\t\tTxnInvoicenum,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tSalesDistrDocNum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tLineItemRefKeyCd,\n\t\tItemTxt,\n\t\tNegativePostingInd,\n\t\tDocArchiveInd,\n\t\tSplGLTransactiontypeCd,\n\t\tRecordModeCd,\n\t\tAssignmentNum,\n\t\tReferenceTxnAmt,\n\t\tReferenceKeyCd,\n\t\tDocstatusCd,\n\t\tLocalCurrAmt,\n\t\tLocalCurr2Amt,\n\t\tLocalCurr3Amt,\n\t\tFiscalYearNum,\n\t\tSecondCurrencyKeyCd,\n\t\tThirdCurrencyKeyCd,\n\t\tFiscalPeriodDt,\n\t\tWBSElementCd,\n\t\tDebitCreditInd,\n\t\tDocCurrencyAmt,\n\t\tProfitCenterCd,\n\t\tInternalDocHeaderKey,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tIsReversedInd,\n\t\tBillingDocNum,\n\t\tbilling_soldto_SoldTo = Select4@SoldTo,\n\t\tPayer,\n\t\tsoldto_payer_SoldTo = SoldToPayerLookup1@SoldTo\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Select5\nCustomer select(mapColumn(\n\t\tCustomerKey,\n\t\tCustomerNum,\n\t\tDunningProcedureCd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> soldtocust\nCustomer select(mapColumn(\n\t\tCustomerKey,\n\t\tCustomerNum,\n\t\tDunningProcedureCd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> payercust\nCustomer select(mapColumn(\n\t\tCustomerKey,\n\t\tCustomerNum,\n\t\tDunningProcedureCd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> BillTo\nBillingDocumentItemData select(mapColumn(\n\t\tSalesDistDocumentNum,\n\t\tBillToParty1Num\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> BillingDocumentItemDataU1\nBillingDocumentItemData select(mapColumn(\n\t\tSalesDistDocumentNum,\n\t\tBillToParty1Num\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> BillingDocumentItemDataNonU1\nCustomerhier select(mapColumn(\n\t\tBaseCustomerHierKey,\n\t\tCustomerNum\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> soldtocusthier\nCustomerhier select(mapColumn(\n\t\tBaseCustomerHierKey,\n\t\tCustomerNum\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> payercusthier\nFinalDailySetWithoutColumn2 select(mapColumn(\n\t\tAgingDate,\n\t\tSoldToCustomerKey,\n\t\tPayerCustomerKey,\n\t\tBillToCustomerKey,\n\t\tSoldToCustomerHierarchyKey,\n\t\tPayerCustomerHierarchyKey,\n\t\tCAMAlignmentKey,\n\t\tCurrentAlignmentKey,\n\t\tPreviousAlignmentKey,\n\t\tAgreementKey,\n\t\tCompanyCd,\n\t\tFiscalYearDt,\n\t\tAccountingDocNum,\n\t\tLineItemNum,\n\t\tSubItemnum,\n\t\tFIItemStatusCd,\n\t\tPayer,\n\t\tTMvsCAMOwnership,\n\t\tCreditControlAreaCd,\n\t\tDunninAreaMeas,\n\t\tAccountTypeCd,\n\t\tGLInd,\n\t\tAccountingDocTypeCd,\n\t\tPostingKeyCd,\n\t\tFiscalVariantCd,\n\t\tDocDt,\n\t\tDocPostingDt,\n\t\tAccDocEnterDt,\n\t\tClearDt,\n\t\tLastDunnDt,\n\t\tNetDueDt,\n\t\tPaymentDtToAvailDiscountI,\n\t\tPaymentDtToAvailDiscountII,\n\t\tBaselineDtForDueDtCalculation,\n\t\tDaysToPayWithinToAvailDiscountI,\n\t\tDaysToPayWithinToAvailDiscountII,\n\t\tNetPayTermsTm,\n\t\tCashDiscountPctI,\n\t\tCashDiscountPctII,\n\t\tCountrCd,\n\t\tPaymentMethodCd,\n\t\tPaymentTermsCode,\n\t\tPaymentBlockKey,\n\t\tReasonCodes,\n\t\tDunningBlock,\n\t\tDunningCd,\n\t\tDunningLevCd,\n\t\tLocalCurrCd,\n\t\tLocalCurrDebitAmt,\n\t\tLocalCurrCreditAmt,\n\t\tLocalCurrSignedAmt,\n\t\tDiscountTakenAndHonoured,\n\t\tCurrencyCd,\n\t\tDocCurrDebitAmt,\n\t\tDocCurrCreditAmt,\n\t\tSignedForeignAmt,\n\t\tEligibleDocDiscountAmt,\n\t\tDocDiscountAmt,\n\t\tChartOfAccountsCd,\n\t\tGLAccountCd,\n\t\tGLAccountNum,\n\t\tBranchAccountnum,\n\t\tClearingDocnum,\n\t\tReferDocNum,\n\t\tTxnInvoicenum,\n\t\tInvoiceFiscalyearNum,\n\t\tInvoicelineItemCd,\n\t\tSalesDistrDocNum,\n\t\tBusinessPartnerRefKey1Cd,\n\t\tBusinessPartnerRefKey2Cd,\n\t\tLineItemRefKeyCd,\n\t\tItemTxt,\n\t\tNegativePostingInd,\n\t\tDocArchiveInd,\n\t\tSplGLTransactiontypeCd,\n\t\tRecordModeCd,\n\t\tAssignmentNum,\n\t\tReferenceTxnAmt,\n\t\tReferenceKeyCd,\n\t\tDocstatusCd,\n\t\tLocalCurrAmt,\n\t\tAmountInSecondLocalCurrency,\n\t\tAmountInThirdLocalCurrency,\n\t\tFiscalYearNum,\n\t\tSecondCurrencyKeyCd,\n\t\tThirdCurrencyKeyCd,\n\t\tFiscalPeriodDt,\n\t\tWBSElementCd,\n\t\tDebitCreditInd,\n\t\tDocCurrencyAmt,\n\t\tProfitCenterCd,\n\t\tInternalDocHeaderKey,\n\t\tODQChangeModeCd,\n\t\tODQEntityCntrCd,\n\t\tIsReversedInd,\n\t\tBillingDoc,\n\t\tInvoiceNum,\n\t\tSoldToCustomer,\n\t\tDunningProcedureCd,\n\t\tLegacySoldToCustomer,\n\t\tURLTxt,\n\t\tOwner,\n\t\tBillToCustomer,\n\t\tJobId,\n\t\tFileCreatedDtTm,\n\t\tFileName,\n\t\tCreatedDttm,\n\t\tLastUpdtDttm,\n\t\tDISequenceNum,\n\t\tDIOperationTypeCd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> finaldailysetwithoutcolumn2select\nSoldToPayerLookup filter(countofsoldto=='1') ~> Filter10\nDerivedColumn1 filter(like(CompanyCd, 'US%')||like(CompanyCd, 'CA%')||like(CompanyCd, 'GB%')||like(CompanyCd, 'IE%')) ~> Filter11\nfinaldailysetwithoutcolumn2select sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($path_AR_Transactions+$tsv_folder+$delta_folder_path+$file_AR_Transactions+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tpartitionBy('hash', 1)) ~> sink1\nfinaldailysetwithoutcolumn2select sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($path_AR_Transactions+$Parquet_folder+$delta_folder_path+$file_AR_Transactions+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tpartitionBy('hash', 1)) ~> sink2\nUnion1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($path_OToC_Aging_Cntl_Daily+$file_OToC_Aging_Cntl_Daily+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> sink3"
		}
	}
}