{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "source1"
				},
				{
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Parquet2",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Join1"
				}
			],
			"script": "source(output(\n\t\tmodifiedby as string,\n\t\tmodifiedon as string,\n\t\thpi_noteshistory as string,\n\t\tcreatedon as string,\n\t\thpi_subject as string,\n\t\thpi_caseid as string,\n\t\tincidentid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tsingleDocument: true) ~> source1\nsource(output(\n\t\tmodifiedby as string,\n\t\tmodifiedon as string,\n\t\thpi_noteshistory as string,\n\t\tcreatedon as string,\n\t\thpi_subject as string,\n\t\thpi_caseid as string,\n\t\tincidentid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tsingleDocument: true) ~> source2\nsource1, source2 join(source1@hpi_caseid == source2@hpi_caseid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nJoin1 sink(input(\n\t\tYearMonthDay as string,\n\t\tDay as date,\n\t\tDayOfMonth as string,\n\t\tDayOfWeek as string,\n\t\tMondayOfWeek as string,\n\t\tSundayOfWeek as string,\n\t\tMonthOfYear as string,\n\t\tLastDayOfMonthIndicator as string,\n\t\tQuarterOfYear as string,\n\t\tWeekOfYear as string,\n\t\tYear as string,\n\t\tYearWeek as string,\n\t\tYearMonth as string,\n\t\tYearQuarter as string,\n\t\tDayOfWeekSales as string,\n\t\tWeekSales as integer,\n\t\tYearWeekSundayStart as string,\n\t\tBDLLoadTimeStamp as timestamp,\n\t\tBDLUpdateTimeStamp as timestamp,\n\t\tBDLFlag as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}