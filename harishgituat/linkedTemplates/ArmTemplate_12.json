{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "harishgituat"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_ACCOUNT_DOCUMENT_TYPE')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "SrcCntl"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewEXPL"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewroute1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "outputparquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "outputtsv"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "updatecntl"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "Union2"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_AccountDocumentType_Cntl as string ('AccountDocumentType_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0AC_DOC_TYP as string ('0AC_DOC_TYP'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_account_document_type as string ('dim_account_document_type'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_ACCOUNT_DOCUMENT_TYPE as string ('ACCOUNT_DOCUMENT_TYPE/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_AccountDocumentType_Cntl+$file_extension_tsv)]) ~> SrcCntl\nsource(output(\n\t\tLanguageKeyCd as string,\n\t\tDocTypeCd as string,\n\t\tDocTypeDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0AC_DOC_TYP+'/'+$file_name_0AC_DOC_TYP+$file_extension_tsv)]) ~> viewEXPL\nsource(output(\n\t\tAccountDocumentTypeKey as long,\n\t\tLanguageKeyCd as string,\n\t\tDocTypeCd as string,\n\t\tDocTypeDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_ACCOUNT_DOCUMENT_TYPE + $file_name_dim_account_document_type + $file_extension_tsv)]) ~> viewroute1\nSrcCntl filter(SubjectArea=='Route' && Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nviewEXPL select(mapColumn(\n\t\tLanguageKeyCd,\n\t\tDocTypeCd,\n\t\tDocTypeDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'AccountDocumentType') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@LanguageKeyCd == lrd@LanguageKeyCd\n\t&& Select1@DocTypeCd == lrd@DocTypeCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(LanguageKeyCd,\n\t\tDocTypeCd,\n\t\tDocTypeDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count(LanguageKeyCd)) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tLanguageKeyCd,\n\t\tDocTypeCd,\n\t\tDocTypeDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(LanguageKeyCd,DocTypeCd), true),\n\tNewAccountDocumentTypeKey = rowNumber()) ~> getDeltaRowNum\nviewroute1 aggregate(MaxAccountDocumentTypeKey = max(AccountDocumentTypeKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(LanguageKeyCd) || !isNull(MaxAccountDocumentTypeKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxAccountDocumentTypeKey = case(isNull(MaxAccountDocumentTypeKey), toLong(0) ,(case(MaxAccountDocumentTypeKey<=0,toLong(0),MaxAccountDocumentTypeKey)))) ~> appendMaxKey\nappendMaxKey derive(AccountDocumentTypeKey = NewAccountDocumentTypeKey+MaxAccountDocumentTypeKey) ~> GetNewKeyDelta\nGetNewKeyDelta, viewroute1 join(Delta@LanguageKeyCd == viewroute1@LanguageKeyCd\n\t&& Delta@DocTypeCd == viewroute1@DocTypeCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(viewroute1@LanguageKeyCd) || isNull(viewroute1@DocTypeCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, viewroute1 join(Delta@LanguageKeyCd == viewroute1@LanguageKeyCd\n\t&& Delta@DocTypeCd == viewroute1@DocTypeCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, viewroute1 join(Delta@LanguageKeyCd == viewroute1@LanguageKeyCd\n\t&& Delta@DocTypeCd == viewroute1@DocTypeCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@LanguageKeyCd) || isNull(Delta@DocTypeCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(Status)) ~> Aggregate2\nSrcCntl derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'AccountDocumentType') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, SrcCntl union(byName: true)~> Union2\nUnion2 sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tLanguageKeyCd,\n\t\tDocTypeCd,\n\t\tDocTypeDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tLanguageKeyCd = Select1@LanguageKeyCd,\n\t\tDocTypeCd = Select1@DocTypeCd,\n\t\tDocTypeDesc = Select1@DocTypeDesc,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tLanguageKeyCd = Delta@LanguageKeyCd,\n\t\tDocTypeCd = Delta@DocTypeCd,\n\t\tDocTypeDesc = Delta@DocTypeDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tAccountDocumentTypeKey = GetNewKeyDelta@AccountDocumentTypeKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tDocTypeDesc = Delta@DocTypeDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tAccountDocumentTypeKey = viewroute1@AccountDocumentTypeKey,\n\t\tLanguageKeyCd = viewroute1@LanguageKeyCd,\n\t\tDocTypeCd = viewroute1@DocTypeCd,\n\t\tCreatedDtTm = viewroute1@CreatedDtTm\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tLanguageKeyCd = viewroute1@LanguageKeyCd,\n\t\tDocTypeCd = viewroute1@DocTypeCd,\n\t\tDocTypeDesc = viewroute1@DocTypeDesc,\n\t\tCreatedDtTm = viewroute1@CreatedDtTm,\n\t\tLastUpdtDtTm = viewroute1@LastUpdtDtTm,\n\t\tIsDeletedInd = viewroute1@IsDeletedInd,\n\t\tAccountDocumentTypeKey = viewroute1@AccountDocumentTypeKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNT_DOCUMENT_TYPE+$file_name_dim_account_document_type+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tAccountDocumentTypeKey,\n\t\tLanguageKeyCd,\n\t\tDocTypeCd,\n\t\tDocTypeDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> outputparquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNT_DOCUMENT_TYPE+$file_name_dim_account_document_type+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tAccountDocumentTypeKey,\n\t\tLanguageKeyCd,\n\t\tDocTypeCd,\n\t\tDocTypeDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> outputtsv\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_AccountDocumentType_Cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> updatecntl"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_CREDIT_CONTROLLING_AREA')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "SrcCntl"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewEXPL"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "view1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "outputparquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "outputtsv"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "updatecntl"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "Union2"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_CreditControlArea_Cntl as string ('CreditControlArea_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0C_CTR_AREA as string ('0C_CTR_AREA'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_credit_controlling_area as string ('dim_credit_controlling_area'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_CREDIT_CONTROLLING_AREA as string ('CREDIT_CONTROLLING_AREA/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_CreditControlArea_Cntl+$file_extension_tsv)]) ~> SrcCntl\nsource(output(\n\t\tCreditControlAreaCd as string,\n\t\tCurrencyKeyCd as string,\n\t\tRiskCatgCd as string,\n\t\tRepresentativeGroupCd as string,\n\t\tLanguageKeyCd as string,\n\t\tCreditControlAreaDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0C_CTR_AREA+'/'+$file_name_0C_CTR_AREA+$file_extension_tsv)]) ~> viewEXPL\nsource(output(\n\t\tCreditControlAreaKey as long,\n\t\tCreditControlAreaCd as string,\n\t\tCurrencyKeyCd as string,\n\t\tRiskCatgCd as string,\n\t\tRepresentativeGroupCd as string,\n\t\tLanguageKeyCd as string,\n\t\tCreditControlAreaDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_CREDIT_CONTROLLING_AREA + $file_name_dim_credit_controlling_area + $file_extension_tsv)]) ~> view1\nSrcCntl filter(SubjectArea=='CreditControlArea' && Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'MM/dd/yyyy HH:mm:ss')))) ~> maxdate\nviewEXPL select(mapColumn(\n\t\tCreditControlAreaCd,\n\t\tCurrencyKeyCd,\n\t\tRiskCatgCd,\n\t\tRepresentativeGroupCd,\n\t\tLanguageKeyCd,\n\t\tCreditControlAreaDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'Route') ~> expl\nexpl, maxdate join(1 == 1 || !isNull(SubjectArea) || !isNull(Subject),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@CreditControlAreaCd == lrd@CreditControlAreaCd\n\t&& Select1@CurrencyKeyCd == lrd@CurrencyKeyCd\n\t&& Select1@LanguageKeyCd == lrd@LanguageKeyCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(CreditControlAreaCd,\n\t\tCurrencyKeyCd,\n\t\tRiskCatgCd,\n\t\tRepresentativeGroupCd,\n\t\tLanguageKeyCd,\n\t\tCreditControlAreaDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count(LanguageKeyCd)) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tCreditControlAreaCd,\n\t\tCurrencyKeyCd,\n\t\tRiskCatgCd,\n\t\tRepresentativeGroupCd,\n\t\tLanguageKeyCd,\n\t\tCreditControlAreaDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(CreditControlAreaCd,CurrencyKeyCd,LanguageKeyCd), true),\n\tNewCreditControlAreaKey = rowNumber()) ~> getDeltaRowNum\nview1 aggregate(MaxCreditControlAreaKey = max(CreditControlAreaKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(LanguageKeyCd) || !isNull(MaxCreditControlAreaKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxCreditControlAreaKey = case(isNull(MaxCreditControlAreaKey), toLong(0) ,(case(MaxCreditControlAreaKey<=0,toLong(0),MaxCreditControlAreaKey)))) ~> appendMaxKey\nappendMaxKey derive(CreditControlAreaKey = NewCreditControlAreaKey+MaxCreditControlAreaKey) ~> GetNewKeyDelta\nGetNewKeyDelta, view1 join(Delta@CreditControlAreaCd == view1@CreditControlAreaCd\n\t&& Delta@CurrencyKeyCd == view1@CurrencyKeyCd\n\t&& Delta@LanguageKeyCd == view1@LanguageKeyCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(view1@CreditControlAreaKey) || isNull(view1@CreditControlAreaCd)||isNull(view1@LanguageKeyCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, view1 join(Delta@CreditControlAreaCd == view1@CreditControlAreaCd\n\t&& Delta@CurrencyKeyCd == view1@CurrencyKeyCd\n\t&& Delta@LanguageKeyCd == view1@LanguageKeyCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, view1 join(Delta@CreditControlAreaCd == view1@CreditControlAreaCd\n\t&& Delta@CurrencyKeyCd == view1@CurrencyKeyCd\n\t&& Delta@LanguageKeyCd == view1@LanguageKeyCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@CreditControlAreaCd) || isNull(Delta@CurrencyKeyCd)||isNull(Delta@LanguageKeyCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(Status)) ~> Aggregate2\nSrcCntl derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'CreditControlArea') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, SrcCntl union(byName: true)~> Union2\nUnion2 sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tCreditControlAreaCd,\n\t\tCurrencyKeyCd,\n\t\tRiskCatgCd,\n\t\tRepresentativeGroupCd,\n\t\tLanguageKeyCd,\n\t\tCreditControlAreaDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tCreditControlAreaCd = Select1@CreditControlAreaCd,\n\t\tCurrencyKeyCd = Select1@CurrencyKeyCd,\n\t\tRiskCatgCd = Select1@RiskCatgCd,\n\t\tRepresentativeGroupCd = Select1@RepresentativeGroupCd,\n\t\tLanguageKeyCd = Select1@LanguageKeyCd,\n\t\tCreditControlAreaDesc = Select1@CreditControlAreaDesc,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tCreditControlAreaCd = Delta@CreditControlAreaCd,\n\t\tCurrencyKeyCd = Delta@CurrencyKeyCd,\n\t\tRiskCatgCd = Delta@RiskCatgCd,\n\t\tRepresentativeGroupCd = Delta@RepresentativeGroupCd,\n\t\tLanguageKeyCd = Delta@LanguageKeyCd,\n\t\tCreditControlAreaDesc = Delta@CreditControlAreaDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tCreditControlAreaKey = GetNewKeyDelta@CreditControlAreaKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tCreditControlAreaDesc = Delta@CreditControlAreaDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tCreditControlAreaKey = view1@CreditControlAreaKey,\n\t\tCreditControlAreaCd = view1@CreditControlAreaCd,\n\t\tCurrencyKeyCd = view1@CurrencyKeyCd,\n\t\tRiskCatgCd = view1@RiskCatgCd,\n\t\tRepresentativeGroupCd = Delta@RepresentativeGroupCd,\n\t\tLanguageKeyCd = Delta@LanguageKeyCd,\n\t\tCreatedDtTm = view1@CreatedDtTm\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tCreditControlAreaCd = view1@CreditControlAreaCd,\n\t\tCurrencyKeyCd = view1@CurrencyKeyCd,\n\t\tRiskCatgCd = view1@RiskCatgCd,\n\t\tRepresentativeGroupCd = view1@RepresentativeGroupCd,\n\t\tLanguageKeyCd = view1@LanguageKeyCd,\n\t\tCreditControlAreaDesc = view1@CreditControlAreaDesc,\n\t\tCreatedDtTm = view1@CreatedDtTm,\n\t\tLastUpdtDtTm = view1@LastUpdtDtTm,\n\t\tIsDeletedInd = view1@IsDeletedInd,\n\t\tCreditControlAreaKey = view1@CreditControlAreaKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_CREDIT_CONTROLLING_AREA+$file_name_dim_credit_controlling_area+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tCreditControlAreaKey,\n\t\tCreditControlAreaCd,\n\t\tCurrencyKeyCd,\n\t\tRiskCatgCd,\n\t\tRepresentativeGroupCd,\n\t\tLanguageKeyCd,\n\t\tCreditControlAreaDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> outputparquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_CREDIT_CONTROLLING_AREA+$file_name_dim_credit_controlling_area+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tCreditControlAreaKey,\n\t\tCreditControlAreaCd,\n\t\tCurrencyKeyCd,\n\t\tRiskCatgCd,\n\t\tRepresentativeGroupCd,\n\t\tLanguageKeyCd,\n\t\tCreditControlAreaDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> outputtsv\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_CreditControlArea_Cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> updatecntl"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_DUNNING')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "DUNNKEYCntlsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TableDUNNKEYTEXTEXPLsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewdimdunning1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDunningParquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDunningTSV"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "DunningCntlTSV"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "UnionALL"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						},
						{
							"name": "DTypeChange1"
						},
						{
							"name": "DTypeChange2"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_Dunning_Cntl as string ('Dunning_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0DUNN_KEY as string ('0DUNN_KEY'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_dunning as string ('dim_dunning'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_DUNNING as string ('DUNNING/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_Dunning_Cntl+$file_extension_tsv)]) ~> DUNNKEYCntlsource\nsource(output(\n\t\tLanguageCd as string,\n\t\tDunningKeyCd as string,\n\t\tDunningKeyDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0DUNN_KEY+'/'+$file_name_0DUNN_KEY+$file_extension_tsv)]) ~> TableDUNNKEYTEXTEXPLsource\nsource(output(\n\t\tDunningKey as string,\n\t\tLanguageCd as string,\n\t\tDunningKeyCd as string,\n\t\tDunningKeyDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_DUNNING + $file_name_dim_dunning + $file_extension_tsv)]) ~> viewdimdunning1\nDUNNKEYCntlsource filter(SubjectArea=='Dunning'&& Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nDTypeChange1 select(mapColumn(\n\t\tLanguageCd,\n\t\tDunningKeyCd,\n\t\tDunningKeyDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileName,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'Dunning') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@LanguageCd == lrd@LanguageCd\n\t&& Select1@DunningKeyCd == lrd@DunningKeyCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(LanguageCd,\n\t\tDunningKeyCd,\n\t\tDunningKeyDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count([1])) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tLanguageCd,\n\t\tDunningKeyCd,\n\t\tDunningKeyDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(LanguageCd,DunningKeyCd), true),\n\tNewDunningKey = rowNumber()) ~> getDeltaRowNum\nDTypeChange2 aggregate(MaxDunningKey = max(DunningKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(LanguageCd) || !isNull(MaxDunningKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxDunningKey = case(isNull(MaxDunningKey), toLong(0) ,(case(MaxDunningKey<=0,toLong(0),MaxDunningKey)))) ~> appendMaxKey\nappendMaxKey derive(DunningKey = NewDunningKey+MaxDunningKey) ~> GetNewKeyDelta\nGetNewKeyDelta, viewdimdunning1 join(Delta@LanguageCd == viewdimdunning1@LanguageCd\n\t&& Delta@DunningKeyCd == viewdimdunning1@DunningKeyCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(viewdimdunning1@LanguageCd) || isNull(viewdimdunning1@DunningKeyCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimdunning1@LanguageCd\n\t&& Delta@DunningKeyCd == viewdimdunning1@DunningKeyCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimdunning1@LanguageCd\n\t&& Delta@DunningKeyCd == viewdimdunning1@DunningKeyCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@DunningKeyCd) || isNull(Delta@LanguageCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(1)) ~> Aggregate2\nDUNNKEYCntlsource derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'Dunning') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, DUNNKEYCntlsource union(byName: true)~> UnionALL\nUnionALL sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tLanguageCd,\n\t\tDunningKeyCd,\n\t\tDunningKeyDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tLanguageCd = Select1@LanguageCd,\n\t\tDunningKeyCd = Select1@DunningKeyCd,\n\t\tDunningKeyDesc = Select1@DunningKeyDesc,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tLanguageCd = Delta@LanguageCd,\n\t\tDunningKeyCd = Delta@DunningKeyCd,\n\t\tDunningKeyDesc = Delta@DunningKeyDesc,\n\t\tDunningKey = GetNewKeyDelta@DunningKey,\n\t\tIsDeletedInd = Delta@IsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tDunningKeyDesc = Delta@DunningKeyDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tDunningKey = DTypeChange2@DunningKey,\n\t\tLanguageCd = viewdimdunning1@LanguageCd,\n\t\tDunningKeyCd = viewdimdunning1@DunningKeyCd,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tLanguageCd = viewdimdunning1@LanguageCd,\n\t\tDunningKeyCd = viewdimdunning1@DunningKeyCd,\n\t\tDunningKeyDesc = viewdimdunning1@DunningKeyDesc,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tLastUpdtDtTm = DTypeChange2@LastUpdtDtTm,\n\t\tIsDeletedInd = viewdimdunning1@IsDeletedInd,\n\t\tDunningKey = DTypeChange2@DunningKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nTableDUNNKEYTEXTEXPLsource derive(CreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange1\nviewdimdunning1 derive(DunningKey = toLong(DunningKey),\n\t\tCreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange2\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_DUNNING + $file_name_dim_dunning +$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tDunningKey,\n\t\tLanguageCd,\n\t\tDunningKeyCd,\n\t\tDunningKeyDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimDunningParquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_DUNNING + $file_name_dim_dunning +$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tDunningKey,\n\t\tLanguageCd,\n\t\tDunningKeyCd,\n\t\tDunningKeyDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimDunningTSV\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_Dunning_Cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> DunningCntlTSV"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_DUNNING_BLOCK')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "DUNNBLOCKCntlsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TableDUNNBLOCKTEXTEXPLsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewdimdunningblock1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDunningBlockParquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDunningBlockTSV"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "DunningBlockCntlTSV"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "UnionALL"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						},
						{
							"name": "DTypeChange1"
						},
						{
							"name": "DTypeChange2"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_DunningBlock_Cntl as string ('DunningBlock_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0DUNN_BLOCK as string ('0DUNN_BLOCK'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_dunning_block as string ('dim_dunning_block'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_DUNNING_BLOCK as string ('DUNNING_BLOCK/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_DunningBlock_Cntl+$file_extension_tsv)]) ~> DUNNBLOCKCntlsource\nsource(output(\n\t\tLanguageCd as string,\n\t\tDunningBlockCd as string,\n\t\tDunningBlockDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0DUNN_BLOCK+'/'+$file_name_0DUNN_BLOCK+$file_extension_tsv)]) ~> TableDUNNBLOCKTEXTEXPLsource\nsource(output(\n\t\tDunningBlockKey as string,\n\t\tLanguageCd as string,\n\t\tDunningBlockCd as string,\n\t\tDunningBlockDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_DUNNING_BLOCK + $file_name_dim_dunning_block + $file_extension_tsv)]) ~> viewdimdunningblock1\nDUNNBLOCKCntlsource filter(SubjectArea=='DunningBlock'&& Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nDTypeChange1 select(mapColumn(\n\t\tLanguageCd,\n\t\tDunningBlockCd,\n\t\tDunningBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileName,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'DunningBlock') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@LanguageCd == lrd@LanguageCd\n\t&& Select1@DunningBlockCd == lrd@DunningBlockCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(LanguageCd,\n\t\tDunningBlockCd,\n\t\tDunningBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count([1])) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tLanguageCd,\n\t\tDunningBlockCd,\n\t\tDunningBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(LanguageCd,DunningBlockCd), true),\n\tNewDunningBlockKey = rowNumber()) ~> getDeltaRowNum\nDTypeChange2 aggregate(MaxDunningBlockKey = max(DunningBlockKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(LanguageCd) || !isNull(MaxDunningBlockKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxDunningBlockKey = case(isNull(MaxDunningBlockKey), toLong(0) ,(case(MaxDunningBlockKey<=0,toLong(0),MaxDunningBlockKey)))) ~> appendMaxKey\nappendMaxKey derive(DunningBlockKey = NewDunningBlockKey+MaxDunningBlockKey) ~> GetNewKeyDelta\nGetNewKeyDelta, viewdimdunningblock1 join(Delta@LanguageCd == viewdimdunningblock1@LanguageCd\n\t&& Delta@DunningBlockCd == viewdimdunningblock1@DunningBlockCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(viewdimdunningblock1@LanguageCd) || isNull(viewdimdunningblock1@DunningBlockCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimdunningblock1@LanguageCd\n\t&& Delta@DunningBlockCd == viewdimdunningblock1@DunningBlockCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimdunningblock1@LanguageCd\n\t&& Delta@DunningBlockCd == viewdimdunningblock1@DunningBlockCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@DunningBlockCd) || isNull(Delta@LanguageCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(1)) ~> Aggregate2\nDUNNBLOCKCntlsource derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'DunningBlock') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, DUNNBLOCKCntlsource union(byName: true)~> UnionALL\nUnionALL sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tLanguageCd,\n\t\tDunningBlockCd,\n\t\tDunningBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tLanguageCd = Select1@LanguageCd,\n\t\tDunningBlockCd = Select1@DunningBlockCd,\n\t\tDunningBlockDesc = Select1@DunningBlockDesc,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tLanguageCd = Delta@LanguageCd,\n\t\tDunningBlockCd = Delta@DunningBlockCd,\n\t\tDunningBlockDesc = Delta@DunningBlockDesc,\n\t\tDunningBlockKey = GetNewKeyDelta@DunningBlockKey,\n\t\tIsDeletedInd = Delta@IsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tDunningBlockDesc = Delta@DunningBlockDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tDunningBlockKey = DTypeChange2@DunningBlockKey,\n\t\tLanguageCd = viewdimdunningblock1@LanguageCd,\n\t\tDunningBlockCd = viewdimdunningblock1@DunningBlockCd,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tLanguageCd = viewdimdunningblock1@LanguageCd,\n\t\tDunningBlockCd = viewdimdunningblock1@DunningBlockCd,\n\t\tDunningBlockDesc = viewdimdunningblock1@DunningBlockDesc,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tLastUpdtDtTm = DTypeChange2@LastUpdtDtTm,\n\t\tIsDeletedInd = viewdimdunningblock1@IsDeletedInd,\n\t\tDunningBlockKey = DTypeChange2@DunningBlockKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nTableDUNNBLOCKTEXTEXPLsource derive(CreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange1\nviewdimdunningblock1 derive(DunningBlockKey = toLong(DunningBlockKey),\n\t\tCreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange2\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_DUNNING_BLOCK + $file_name_dim_dunning_block +$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tDunningBlockKey,\n\t\tLanguageCd,\n\t\tDunningBlockCd,\n\t\tDunningBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimDunningBlockParquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_DUNNING_BLOCK + $file_name_dim_dunning_block +$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tDunningBlockKey,\n\t\tLanguageCd,\n\t\tDunningBlockCd,\n\t\tDunningBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimDunningBlockTSV\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_DunningBlock_Cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> DunningBlockCntlTSV"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_PAYMENT_BLOCK')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "PMNTBLOCKCntlsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TablePMNTBLOCKTEXTEXPLsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewdimbillingblock1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimPaymentBlockParquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimPaymentBlockTSV"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "PaymentBlockCntlTSV"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "UnionALL"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						},
						{
							"name": "DTypeChange1"
						},
						{
							"name": "DTypeChange2"
						},
						{
							"name": "Select8"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_PaymentBlock_Cntl as string ('PaymentBlock_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0PMNT_BLOCK as string ('0PMNT_BLOCK'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_block as string ('dim_payment_block'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_BLOCK as string ('PAYMENT_BLOCK/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_PaymentBlock_Cntl+$file_extension_tsv)]) ~> PMNTBLOCKCntlsource\nsource(output(\n\t\tLanguageCd as string,\n\t\tPaymentBlockCd as string,\n\t\tPaymentBlockDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0PMNT_BLOCK+'/'+$file_name_0PMNT_BLOCK+$file_extension_tsv)]) ~> TablePMNTBLOCKTEXTEXPLsource\nsource(output(\n\t\tPaymentBlockKey as string,\n\t\tLanguageCd as string,\n\t\tPaymentBlockCd as string,\n\t\tPaymentBlockDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_PAYMENT_BLOCK + $file_name_dim_payment_block + $file_extension_tsv)]) ~> viewdimbillingblock1\nPMNTBLOCKCntlsource filter(SubjectArea=='PaymentBlock'&& Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nDTypeChange1 select(mapColumn(\n\t\tLanguageCd,\n\t\tPaymentBlockCd,\n\t\tPaymentBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileName,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'PaymentBlock') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@LanguageCd == lrd@LanguageCd\n\t&& Select1@PaymentBlockCd == lrd@PaymentBlockCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp\r\n(toString\r\n(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss')\r\n,'yyyy-mm-dd HH:mm:ss') \r\n> toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(LanguageCd,\n\t\tPaymentBlockCd,\n\t\tPaymentBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count([1])) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tLanguageCd,\n\t\tPaymentBlockCd,\n\t\tPaymentBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(LanguageCd,PaymentBlockCd), true),\n\tNewPaymentBlockKey = rowNumber()) ~> getDeltaRowNum\nDTypeChange2 aggregate(MaxPaymentBlockKey = max(PaymentBlockKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(LanguageCd) || !isNull(MaxPaymentBlockKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxPaymentBlockKey = case(isNull(MaxPaymentBlockKey), toLong(0) ,(case(MaxPaymentBlockKey<=0,toLong(0),MaxPaymentBlockKey)))) ~> appendMaxKey\nappendMaxKey derive(PaymentBlockKey = NewPaymentBlockKey+MaxPaymentBlockKey) ~> GetNewKeyDelta\nGetNewKeyDelta, viewdimbillingblock1 join(Delta@LanguageCd == viewdimbillingblock1@LanguageCd\n\t&& Delta@PaymentBlockCd == viewdimbillingblock1@PaymentBlockCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(viewdimbillingblock1@LanguageCd) || isNull(viewdimbillingblock1@PaymentBlockCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimbillingblock1@LanguageCd\n\t&& Delta@PaymentBlockCd == viewdimbillingblock1@PaymentBlockCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimbillingblock1@LanguageCd\n\t&& Delta@PaymentBlockCd == viewdimbillingblock1@PaymentBlockCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@PaymentBlockCd) || isNull(Delta@LanguageCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(1)) ~> Aggregate2\nPMNTBLOCKCntlsource derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'PaymentBlock') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, PMNTBLOCKCntlsource union(byName: true)~> UnionALL\nUnionALL sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tLanguageCd,\n\t\tPaymentBlockCd,\n\t\tPaymentBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tLanguageCd = Select1@LanguageCd,\n\t\tPaymentBlockCd = Select1@PaymentBlockCd,\n\t\tPaymentBlockDesc = Select1@PaymentBlockDesc,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tLanguageCd = Delta@LanguageCd,\n\t\tPaymentBlockCd = Delta@PaymentBlockCd,\n\t\tPaymentBlockDesc = Delta@PaymentBlockDesc,\n\t\tPaymentBlockKey = GetNewKeyDelta@PaymentBlockKey,\n\t\tIsDeletedInd = Delta@IsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tPaymentBlockKey = DTypeChange2@PaymentBlockKey,\n\t\tLanguageCd = viewdimbillingblock1@LanguageCd,\n\t\tPaymentBlockCd = viewdimbillingblock1@PaymentBlockCd,\n\t\tPaymentBlockDesc = Delta@PaymentBlockDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tPaymentBlockKey = DTypeChange2@PaymentBlockKey,\n\t\tLanguageCd = viewdimbillingblock1@LanguageCd,\n\t\tPaymentBlockCd = viewdimbillingblock1@PaymentBlockCd,\n\t\tPaymentBlockDesc = viewdimbillingblock1@PaymentBlockDesc,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tLastUpdtDtTm = DTypeChange2@LastUpdtDtTm,\n\t\tIsDeletedInd = viewdimbillingblock1@IsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nTablePMNTBLOCKTEXTEXPLsource derive(CreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange1\nviewdimbillingblock1 derive(PaymentBlockKey = toLong(PaymentBlockKey),\n\t\tCreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange2\nUnion3 select(mapColumn(\n\t\tPaymentBlockKey,\n\t\tLanguageCd,\n\t\tPaymentBlockCd,\n\t\tPaymentBlockDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select8\nSelect8 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_BLOCK + $file_name_dim_payment_block +$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tpartitionBy('hash', 1)) ~> dimPaymentBlockParquet\nSelect8 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_BLOCK + $file_name_dim_payment_block +$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tpartitionBy('hash', 1)) ~> dimPaymentBlockTSV\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_PaymentBlock_Cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> PaymentBlockCntlTSV"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_PAYMENT_METHOD')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "SrcCntl"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewEXPL"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "view1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "outputparquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "outputtsv"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "updatecntl"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "UnionALL"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_PaymentMethod_Cntl as string ('PaymentMethod_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0PYMT_METH as string ('0PYMT_METH'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_method as string ('dim_payment_method'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_METHOD as string ('PAYMENT_METHOD/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_PaymentMethod_Cntl+$file_extension_tsv)]) ~> SrcCntl\nsource(output(\n\t\tCountryCd as string,\n\t\tPaymentMethCd as string,\n\t\tPaymentMethName as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0PYMT_METH+'/'+$file_name_0PYMT_METH+$file_extension_tsv)]) ~> viewEXPL\nsource(output(\n\t\tPaymentMethodKey as long,\n\t\tCountryCd as string,\n\t\tPaymentMethCd as string,\n\t\tPaymentMethName as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_PAYMENT_METHOD + $file_name_dim_payment_method + $file_extension_tsv)]) ~> view1\nSrcCntl filter(SubjectArea=='PaymentMethod' && Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nviewEXPL select(mapColumn(\n\t\tCountryCd,\n\t\tPaymentMethCd,\n\t\tPaymentMethName,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'PaymentMethod') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@CountryCd == lrd@CountryCd\n\t&& Select1@PaymentMethCd == lrd@PaymentMethCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(CountryCd,\n\t\tPaymentMethCd,\n\t\tPaymentMethName,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count(CountryCd)) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tCountryCd,\n\t\tPaymentMethCd,\n\t\tPaymentMethName,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(CountryCd,PaymentMethCd), true),\n\tNewPaymentMethodKey = rowNumber()) ~> getDeltaRowNum\nview1 aggregate(MaxPaymentMethodKey = max(PaymentMethodKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(CountryCd) || !isNull(MaxPaymentMethodKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxPaymentMethodKey = case(isNull(MaxPaymentMethodKey), toLong(0) ,(case(MaxPaymentMethodKey<=0,toLong(0),MaxPaymentMethodKey)))) ~> appendMaxKey\nappendMaxKey derive(PaymentMethodKey = NewPaymentMethodKey+MaxPaymentMethodKey) ~> GetNewKeyDelta\nGetNewKeyDelta, view1 join(Delta@CountryCd == view1@CountryCd\n\t&& Delta@PaymentMethCd == view1@PaymentMethCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(view1@CountryCd) || isNull(view1@PaymentMethCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, view1 join(Delta@CountryCd == view1@CountryCd\n\t&& Delta@PaymentMethCd == view1@PaymentMethCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, view1 join(Delta@CountryCd == view1@CountryCd\n\t&& Delta@PaymentMethCd == view1@PaymentMethCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@CountryCd) || isNull(Delta@PaymentMethCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(1)) ~> Aggregate2\nSrcCntl derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'PaymentMethod') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, SrcCntl union(byName: true)~> UnionALL\nUnionALL sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tCountryCd,\n\t\tPaymentMethCd,\n\t\tPaymentMethName,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tCountryCd = Select1@CountryCd,\n\t\tPaymentMethCd = Select1@PaymentMethCd,\n\t\tPaymentMethName = Select1@PaymentMethName,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tCountryCd = Delta@CountryCd,\n\t\tPaymentMethCd = Delta@PaymentMethCd,\n\t\tPaymentMethName = Delta@PaymentMethName,\n\t\tCreatedDtTm = Delta@CreatedDtTm,\n\t\tLastUpdtDtTm = Delta@LastUpdtDtTm,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tPaymentMethodKey = GetNewKeyDelta@PaymentMethodKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tPaymentMethName = Delta@PaymentMethName,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tCountryCd = view1@CountryCd,\n\t\tPaymentMethCd = view1@PaymentMethCd,\n\t\tCreatedDtTm = view1@CreatedDtTm,\n\t\tLastUpdtDtTm = view1@LastUpdtDtTm,\n\t\tPaymentMethodKey = view1@PaymentMethodKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tCountryCd = view1@CountryCd,\n\t\tPaymentMethCd = view1@PaymentMethCd,\n\t\tPaymentMethName = view1@PaymentMethName,\n\t\tCreatedDtTm = view1@CreatedDtTm,\n\t\tLastUpdtDtTm = view1@LastUpdtDtTm,\n\t\tIsDeletedInd = view1@IsDeletedInd,\n\t\tPaymentMethodKey = view1@PaymentMethodKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_METHOD + $file_name_dim_payment_method +$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tPaymentMethodKey,\n\t\tCountryCd,\n\t\tPaymentMethCd,\n\t\tPaymentMethName,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> outputparquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_METHOD + $file_name_dim_payment_method +$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tPaymentMethodKey,\n\t\tCountryCd,\n\t\tPaymentMethCd,\n\t\tPaymentMethName,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> outputtsv\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_PaymentMethod_Cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> updatecntl"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_PAYMENT_REASON')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "REASONCDECntlsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TableREASONCDETEXTEXPLsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewdimroute1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimPaymentReasonParquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimPaymentReasonTSV"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "PaymentReasonCntlTSV"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "UnionALL"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						},
						{
							"name": "DTypeChange1"
						},
						{
							"name": "DTypeChange2"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_P as string ('PaymentReason_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0REASON_CDE as string ('0REASON_CDE'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_reaareason as string ('dim_payment_reason'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_REASON as string ('PAYMENT_REASON/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_P+$file_extension_tsv)]) ~> REASONCDECntlsource\nsource(output(\n\t\tLanguageCd as string,\n\t\tCompanyCd as string,\n\t\tPaymentReasonCd as string,\n\t\tReasonShortTxt as string,\n\t\tReasonLongTxt as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0REASON_CDE+'/'+$file_name_0REASON_CDE+$file_extension_tsv)]) ~> TableREASONCDETEXTEXPLsource\nsource(output(\n\t\tPaymentReasonKey as string,\n\t\tLanguageCd as string,\n\t\tCompanyCd as string,\n\t\tPaymentReasonCd as string,\n\t\tReasonShortTxt as string,\n\t\tReasonLongTxt as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_PAYMENT_REASON + $file_name_dim_payment_reaareason + $file_extension_tsv)]) ~> viewdimroute1\nREASONCDECntlsource filter(SubjectArea=='PaymentReason'&& Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nDTypeChange1 select(mapColumn(\n\t\tLanguageCd,\n\t\tCompanyCd,\n\t\tPaymentReasonCd,\n\t\tReasonShortTxt,\n\t\tReasonLongTxt,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileName,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'PaymentReason') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@LanguageCd == lrd@LanguageCd\n\t&& Select1@CompanyCd == lrd@CompanyCd\n\t&& Select1@PaymentReasonCd == lrd@PaymentReasonCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(LanguageCd,\n\t\tCompanyCd,\n\t\tPaymentReasonCd,\n\t\tReasonShortTxt,\n\t\tReasonLongTxt,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count([1])) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tLanguageCd,\n\t\tCompanyCd,\n\t\tPaymentReasonCd,\n\t\tReasonShortTxt,\n\t\tReasonLongTxt,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(LanguageCd,CompanyCd,PaymentReasonCd), true),\n\tNewPaymentReasonKey = rowNumber()) ~> getDeltaRowNum\nDTypeChange2 aggregate(MaxPaymentReasonKey = max(PaymentReasonKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(LanguageCd) || !isNull(MaxPaymentReasonKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxPaymentReasonKey = case(isNull(MaxPaymentReasonKey), toLong(0) ,(case(MaxPaymentReasonKey<=0,toLong(0),MaxPaymentReasonKey)))) ~> appendMaxKey\nappendMaxKey derive(PaymentReasonKey = NewPaymentReasonKey+MaxPaymentReasonKey) ~> GetNewKeyDelta\nGetNewKeyDelta, viewdimroute1 join(Delta@LanguageCd == viewdimroute1@LanguageCd\n\t&& Delta@CompanyCd == viewdimroute1@CompanyCd\n\t&& Delta@PaymentReasonCd == viewdimroute1@PaymentReasonCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(viewdimroute1@LanguageCd) || isNull(viewdimroute1@CompanyCd) || isNull(viewdimroute1@PaymentReasonCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimroute1@LanguageCd\n\t&& Delta@CompanyCd == viewdimroute1@CompanyCd\n\t&& Delta@PaymentReasonCd == viewdimroute1@PaymentReasonCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, DTypeChange2 join(Delta@LanguageCd == viewdimroute1@LanguageCd\n\t&& Delta@CompanyCd == viewdimroute1@CompanyCd\n\t&& Delta@PaymentReasonCd == viewdimroute1@PaymentReasonCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@CompanyCd) || isNull(Delta@LanguageCd) || isNull(Delta@PaymentReasonCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(1)) ~> Aggregate2\nREASONCDECntlsource derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'PaymentReason') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, REASONCDECntlsource union(byName: true)~> UnionALL\nUnionALL sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tLanguageCd,\n\t\tCompanyCd,\n\t\tPaymentReasonCd,\n\t\tReasonShortTxt,\n\t\tReasonLongTxt,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tLanguageCd = Select1@LanguageCd,\n\t\tCompanyCd = Select1@CompanyCd,\n\t\tPaymentReasonCd = Select1@PaymentReasonCd,\n\t\tReasonShortTxt = Select1@ReasonShortTxt,\n\t\tReasonLongTxt = Select1@ReasonLongTxt,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tLanguageCd = Delta@LanguageCd,\n\t\tCompanyCd = Delta@CompanyCd,\n\t\tPaymentReasonCd = Delta@PaymentReasonCd,\n\t\tReasonShortTxt = Delta@ReasonShortTxt,\n\t\tReasonLongTxt = Delta@ReasonLongTxt,\n\t\tPaymentReasonKey = GetNewKeyDelta@PaymentReasonKey,\n\t\tIsDeletedInd = Delta@IsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tPaymentReasonCd = viewdimroute1@PaymentReasonCd,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tPaymentReasonKey = DTypeChange2@PaymentReasonKey,\n\t\tLanguageCd = viewdimroute1@LanguageCd,\n\t\tCompanyCd = viewdimroute1@CompanyCd,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tReasonShortTxt = Delta@ReasonShortTxt,\n\t\tReasonLongTxt = Delta@ReasonLongTxt\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tLanguageCd = viewdimroute1@LanguageCd,\n\t\tCompanyCd = viewdimroute1@CompanyCd,\n\t\tPaymentReasonCd = viewdimroute1@PaymentReasonCd,\n\t\tReasonShortTxt = viewdimroute1@ReasonShortTxt,\n\t\tReasonLongTxt = viewdimroute1@ReasonLongTxt,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tLastUpdtDtTm = DTypeChange2@LastUpdtDtTm,\n\t\tIsDeletedInd = viewdimroute1@IsDeletedInd,\n\t\tPaymentReasonKey = DTypeChange2@PaymentReasonKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nTableREASONCDETEXTEXPLsource derive(CreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange1\nviewdimroute1 derive(PaymentReasonKey = toLong(PaymentReasonKey),\n\t\tCreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange2\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_REASON + $file_name_dim_payment_reaareason +$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tPaymentReasonKey,\n\t\tLanguageCd,\n\t\tCompanyCd,\n\t\tPaymentReasonCd,\n\t\tReasonShortTxt,\n\t\tReasonLongTxt,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimPaymentReasonParquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_REASON + $file_name_dim_payment_reaareason +$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tPaymentReasonKey,\n\t\tLanguageCd,\n\t\tCompanyCd,\n\t\tPaymentReasonCd,\n\t\tReasonShortTxt,\n\t\tReasonLongTxt,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimPaymentReasonTSV\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_P+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> PaymentReasonCntlTSV"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ELSE_ECOLABDATALAKE_AZONE_DIM_PAYMENT_TERM')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "IDPAYTERMBRCntlsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TableIDPAYTERMBRTEXTEXPLsource"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "viewdimroute1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimPaymentTermParquet"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimPaymentTermTSV"
						},
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "PaymentTermCntlTSV"
						}
					],
					"transformations": [
						{
							"name": "Filter1"
						},
						{
							"name": "maxdate"
						},
						{
							"name": "Select1"
						},
						{
							"name": "expl"
						},
						{
							"name": "Join1"
						},
						{
							"name": "Join2"
						},
						{
							"name": "Filter2"
						},
						{
							"name": "Aggregate1"
						},
						{
							"name": "Delta"
						},
						{
							"name": "getDeltaRowNum"
						},
						{
							"name": "MaxDimKey"
						},
						{
							"name": "Join3"
						},
						{
							"name": "appendMaxKey"
						},
						{
							"name": "GetNewKeyDelta"
						},
						{
							"name": "Join4"
						},
						{
							"name": "Filter3"
						},
						{
							"name": "Inserts"
						},
						{
							"name": "Join5"
						},
						{
							"name": "Updates"
						},
						{
							"name": "Join6"
						},
						{
							"name": "Filter4"
						},
						{
							"name": "Aggregate2"
						},
						{
							"name": "DerivedColumn4"
						},
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "UnionALL"
						},
						{
							"name": "Sort1"
						},
						{
							"name": "lrd"
						},
						{
							"name": "Select5"
						},
						{
							"name": "Select6"
						},
						{
							"name": "Select7"
						},
						{
							"name": "Existing"
						},
						{
							"name": "Union3"
						},
						{
							"name": "DTypeChange1"
						},
						{
							"name": "DTypeChange2"
						}
					],
					"script": "parameters{\n\tAudit_Path as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tsrc_filename_Audit_PaymentTerm_cntl as string ('PaymentTerm_Cntl'),\n\tfile_extension_tsv as string ('.tsv'),\n\tsrc_path_Exploration as string ('Exploration/EnterpriseBackbone/EBS/'),\n\tfile_name_0ID_PAYTERM_BR as string ('0ID_PAYTERM_BR'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_term as string ('dim_payment_term'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_TERM as string ('PAYMENT_TERM/')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Audit_Path+$src_filename_Audit_PaymentTerm_cntl+$file_extension_tsv)]) ~> IDPAYTERMBRCntlsource\nsource(output(\n\t\tClientCd as string,\n\t\tTermsofPaymentKeyCd as string,\n\t\tValidityAreaofConditionDesc as string,\n\t\tFirstPaymentTermExplanationDesc as string,\n\t\tSecondPaymentTermExplanationDesc as string,\n\t\tNetPaymentTermExplanationDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tJobId as string,\n\t\tFileName as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_Exploration+$file_name_0ID_PAYTERM_BR+'/'+$file_name_0ID_PAYTERM_BR+$file_extension_tsv)]) ~> TableIDPAYTERMBRTEXTEXPLsource\nsource(output(\n\t\tPaymentTermKey as string,\n\t\tClientCd as string,\n\t\tTermsofPaymentKeyCd as string,\n\t\tValidityAreaofConditionDesc as string,\n\t\tFirstPaymentTermExplanationDesc as string,\n\t\tSecondPaymentTermExplanationDesc as string,\n\t\tNetPaymentTermExplanationDesc as string,\n\t\tCreatedDtTm as string,\n\t\tLastUpdtDtTm as string,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($Analytics_Path + $Analytics_Folder_PAYMENT_TERM + $file_name_dim_payment_term + $file_extension_tsv)]) ~> viewdimroute1\nIDPAYTERMBRCntlsource filter(SubjectArea=='PaymentTerm'&& Status=='S') ~> Filter1\nFilter1 aggregate(groupBy(SubjectArea,\n\t\tStatus),\n\tLastRunDate = max(toString(toTimestamp(LastRunDate,'M/d/yyyy h:mm:ss a')))) ~> maxdate\nDTypeChange1 select(mapColumn(\n\t\tClientCd,\n\t\tTermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tJobId,\n\t\tFileName,\n\t\tIsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(CreatedDtTm = coalesce(CreatedDtTm,'01/01/1900 00:00:00'),\n\t\tLastUpdtDtTm = coalesce(LastUpdtDtTm,'01/01/1900 00:00:00'),\n\t\tSubject = 'PaymentTerm') ~> expl\nexpl, maxdate join(SubjectArea == Subject,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join1\nexpl, lrd join(Select1@ClientCd == lrd@ClientCd\n\t&& Select1@TermsofPaymentKeyCd == lrd@TermsofPaymentKeyCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 filter(toTimestamp(toString(toTimestamp(expl@LastUpdtDtTm,'MM/dd/yyyy HH:mm:ss'),'yyyy-mm-dd HH:mm:ss'),'yyyy-mm-dd HH:mm:ss') > toTimestamp(LastRunDate,'yyyy-mm-dd HH:mm:ss')) ~> Filter2\nSelect5 aggregate(groupBy(ClientCd,\n\t\tTermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject),\n\tdummy = count([1])) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\tClientCd,\n\t\tTermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Delta\nDelta window(desc(concat(ClientCd,TermsofPaymentKeyCd), true),\n\tNewPaymentTermKey = rowNumber()) ~> getDeltaRowNum\nDTypeChange2 aggregate(MaxPaymentTermKey = max(PaymentTermKey)) ~> MaxDimKey\ngetDeltaRowNum, MaxDimKey join(1 == 1 || !isNull(ClientCd) || !isNull(MaxPaymentTermKey),\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> Join3\nJoin3 derive(MaxPaymentTermKey = case(isNull(MaxPaymentTermKey), toLong(0) ,(case(MaxPaymentTermKey<=0,toLong(0),MaxPaymentTermKey)))) ~> appendMaxKey\nappendMaxKey derive(PaymentTermKey = NewPaymentTermKey+MaxPaymentTermKey) ~> GetNewKeyDelta\nGetNewKeyDelta, viewdimroute1 join(Delta@ClientCd == viewdimroute1@ClientCd\n\t&& Delta@TermsofPaymentKeyCd == viewdimroute1@TermsofPaymentKeyCd,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 filter(isNull(viewdimroute1@ClientCd) || isNull(viewdimroute1@TermsofPaymentKeyCd)) ~> Filter3\nSelect6 derive(CreatedDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss'),\n\t\tLastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Inserts\nGetNewKeyDelta, DTypeChange2 join(Delta@ClientCd == viewdimroute1@ClientCd\n\t&& Delta@TermsofPaymentKeyCd == viewdimroute1@TermsofPaymentKeyCd,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join5\nSelect7 derive(LastUpdtDtTm = toString(currentTimestamp(),'MM/dd/yyyy HH:mm:ss')) ~> Updates\nGetNewKeyDelta, DTypeChange2 join(Delta@ClientCd == viewdimroute1@ClientCd\n\t&& Delta@TermsofPaymentKeyCd == viewdimroute1@TermsofPaymentKeyCd,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> Join6\nJoin6 filter(isNull(Delta@TermsofPaymentKeyCd) || isNull(Delta@ClientCd)) ~> Filter4\nDerivedColumn4 aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = count(1)) ~> Aggregate2\nIDPAYTERMBRCntlsource derive(LastRunDate = toString(currentTimestamp(),'M/d/yyyy h:mm:ss a'),\n\t\tStatus = 'S',\n\t\tSubjectArea = 'PaymentTerm') ~> DerivedColumn4\nAggregate2 select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> getnewcntlvalue\ngetnewcntlvalue, IDPAYTERMBRCntlsource union(byName: true)~> UnionALL\nUnionALL sort(asc(LastRunDate, true)) ~> Sort1\nJoin1 select(mapColumn(\n\t\tClientCd,\n\t\tTermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd,\n\t\tSubject,\n\t\tLastRunDate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lrd\nFilter2 select(mapColumn(\n\t\tClientCd = Select1@ClientCd,\n\t\tTermsofPaymentKeyCd = Select1@TermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc = Select1@ValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc = Select1@FirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc = Select1@SecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc = Select1@NetPaymentTermExplanationDesc,\n\t\tCreatedDtTm = expl@CreatedDtTm,\n\t\tLastUpdtDtTm = expl@LastUpdtDtTm,\n\t\tIsDeletedInd = Select1@IsDeletedInd,\n\t\tSubject = expl@Subject\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nFilter3 select(mapColumn(\n\t\tClientCd = Delta@ClientCd,\n\t\tTermsofPaymentKeyCd = Delta@TermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc = Delta@ValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc = Delta@FirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc = Delta@SecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc = Delta@NetPaymentTermExplanationDesc,\n\t\tPaymentTermKey = GetNewKeyDelta@PaymentTermKey,\n\t\tIsDeletedInd = Delta@IsDeletedInd\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nJoin5 select(mapColumn(\n\t\tValidityAreaofConditionDesc = Delta@ValidityAreaofConditionDesc,\n\t\tIsDeletedInd = Delta@IsDeletedInd,\n\t\tPaymentTermKey = DTypeChange2@PaymentTermKey,\n\t\tClientCd = viewdimroute1@ClientCd,\n\t\tTermsofPaymentKeyCd = viewdimroute1@TermsofPaymentKeyCd,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tFirstPaymentTermExplanationDesc = viewdimroute1@FirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc = Delta@SecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc = Delta@NetPaymentTermExplanationDesc\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Select7\nFilter4 select(mapColumn(\n\t\tClientCd = viewdimroute1@ClientCd,\n\t\tTermsofPaymentKeyCd = viewdimroute1@TermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc = viewdimroute1@ValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc = viewdimroute1@FirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc = viewdimroute1@SecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc = viewdimroute1@NetPaymentTermExplanationDesc,\n\t\tCreatedDtTm = DTypeChange2@CreatedDtTm,\n\t\tLastUpdtDtTm = DTypeChange2@LastUpdtDtTm,\n\t\tIsDeletedInd = viewdimroute1@IsDeletedInd,\n\t\tPaymentTermKey = DTypeChange2@PaymentTermKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: false) ~> Existing\nInserts, Updates, Existing union(byName: true)~> Union3\nTableIDPAYTERMBRTEXTEXPLsource derive(CreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange1\nviewdimroute1 derive(PaymentTermKey = toLong(PaymentTermKey),\n\t\tCreatedDtTm = toString(CreatedDtTm),\n\t\tLastUpdtDtTm = toString(LastUpdtDtTm)) ~> DTypeChange2\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_TERM + $file_name_dim_payment_term +$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\tPaymentTermKey,\n\t\tClientCd,\n\t\tTermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimPaymentTermParquet\nUnion3 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path + $Analytics_Folder_PAYMENT_TERM + $file_name_dim_payment_term +$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\tPaymentTermKey,\n\t\tClientCd,\n\t\tTermsofPaymentKeyCd,\n\t\tValidityAreaofConditionDesc,\n\t\tFirstPaymentTermExplanationDesc,\n\t\tSecondPaymentTermExplanationDesc,\n\t\tNetPaymentTermExplanationDesc,\n\t\tCreatedDtTm,\n\t\tLastUpdtDtTm,\n\t\tIsDeletedInd\n\t),\n\tpartitionBy('hash', 1)) ~> dimPaymentTermTSV\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Audit_Path+$src_filename_Audit_PaymentTerm_cntl+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 3,\n\tpartitionBy('hash', 1)) ~> PaymentTermCntlTSV"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/GenericControlFileUpdate')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Generic/ControlFiles"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "CntlSource"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "CntlOutput"
						}
					],
					"transformations": [
						{
							"name": "getnewcntlvalue"
						},
						{
							"name": "Distinct"
						},
						{
							"name": "SelectRequiredColumns"
						},
						{
							"name": "updatecntl"
						}
					],
					"script": "parameters{\n\tFilePath as string ('Analytics/EnterpriseCertified/EnterpriseApps/CommercialReporting/AUDIT_DATA/'),\n\tFileName as string ('Customer_Cntl'),\n\tStatus as string ('S'),\n\tSubjectArea as string ('Customer'),\n\tTimeFormat as string ('M/d/yyyy h:mm:ss a')\n}\nsource(output(\n\t\tLastRunDate as string,\n\t\tStatus as string,\n\t\tSubjectArea as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($FilePath+$FileName+'.tsv')]) ~> CntlSource\nCntlSource derive(LastRunDate = toString(currentTimestamp(),$TimeFormat),\n\t\tStatus = $Status,\n\t\tSubjectArea = $SubjectArea) ~> getnewcntlvalue\ngetnewcntlvalue aggregate(groupBy(LastRunDate,\n\t\tStatus,\n\t\tSubjectArea),\n\tdummy = min(LastRunDate)) ~> Distinct\nDistinct select(mapColumn(\n\t\tLastRunDate,\n\t\tStatus,\n\t\tSubjectArea\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectRequiredColumns\nCntlSource, SelectRequiredColumns union(byName: true)~> updatecntl\nupdatecntl sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($FilePath+$FileName+'.tsv')],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> CntlOutput"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_ACCOUNTING_TYPE')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_accounting_type as string ('dim_accounting_type'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_ACCOUNTING_TYPE as string ('ACCOUNTING_TYPE/')\n}\nsource(output(\n\t\tAccountingTypeKey as short,\n\t\tLanguageKeyCd as short,\n\t\tTextDatasourceKeyCd as short,\n\t\tLongDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_accounting_type +'_dummy'+ $file_extension_tsv)]) ~> dimDummy\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNTING_TYPE+$file_name_dim_accounting_type+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNTING_TYPE+$file_name_dim_accounting_type+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_ACCOUNT_CHART')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_account_chart as string ('dim_account_chart'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_ACCOUNT_CHART as string ('ACCOUNT_CHART/')\n}\nsource(output(\n\t\tAccountChartKey as short,\n\t\tLanguageKeyCd as short,\n\t\tAccountsChartCd as short,\n\t\tAccountsChartDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_account_chart +'_dummy'+ $file_extension_tsv)]) ~> dimDummy\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNT_CHART+$file_name_dim_account_chart+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNT_CHART+$file_name_dim_account_chart+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_ACCOUNT_DOCUMENT_TYPE')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_account_document_type as string ('dim_account_document_type'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_ACCOUNT_DOCUMENT_TYPE as string ('ACCOUNT_DOCUMENT_TYPE/')\n}\nsource(output(\n\t\tAccountDocumentTypeKey as short,\n\t\tLanguageKeyCd as short,\n\t\tDocTypeCd as short,\n\t\tDocTypeDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_account_document_type +'_dummy'+ $file_extension_tsv)]) ~> dimDummy\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNT_DOCUMENT_TYPE+$file_name_dim_account_document_type+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_ACCOUNT_DOCUMENT_TYPE+$file_name_dim_account_document_type+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_CREDIT_CONTROLLING_AREA')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimCreditControllingAreaDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_credit_controlling_area as string ('dim_credit_controlling_area'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_CREDIT_CONTROLLING_AREA as string ('CREDIT_CONTROLLING_AREA/')\n}\nsource(output(\n\t\tCreditControlAreaKey as short,\n\t\tCreditControlAreaCd as short,\n\t\tCurrencyKeyCd as short,\n\t\tRiskCatgCd as short,\n\t\tRepresentativeGroupCd as short,\n\t\tLanguageKeyCd as short,\n\t\tCreditControlAreaDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_credit_controlling_area+'_dummy' + $file_extension_tsv)]) ~> dimCreditControllingAreaDummy\ndimCreditControllingAreaDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_CREDIT_CONTROLLING_AREA+$file_name_dim_credit_controlling_area+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimCreditControllingAreaDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_CREDIT_CONTROLLING_AREA+$file_name_dim_credit_controlling_area+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_DUNNING')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimdunningDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimrouteTSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimrouteParquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tfile_name_dim_stor_chan as string ('dim_dunning'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tAnalytics_Folder_DUNNING as string ('DUNNING/'),\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/')\n}\nsource(output(\n\t\tDunningKey as short,\n\t\tLanguageCd as short,\n\t\tDunningKeyCd as short,\n\t\tDunningKeyDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_stor_chan + '_dummy' + $file_extension_tsv)]) ~> dimdunningDummy\ndimdunningDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+ $Analytics_Folder_DUNNING+$file_name_dim_stor_chan+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> dimrouteTSV\ndimdunningDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+ $Analytics_Folder_DUNNING+$file_name_dim_stor_chan+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> dimrouteParquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_DUNNING_BLOCK')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimdunningblockDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimrouteTSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimrouteParquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tfile_name_dim_dunning_block as string ('dim_dunning_block'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tAnalytics_Folder_DUNNING_BLOCK as string ('DUNNING_BLOCK/'),\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/')\n}\nsource(output(\n\t\tDunningBlockKey as short,\n\t\tLanguageCd as short,\n\t\tDunningBlockCd as short,\n\t\tDunningBlockDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_dunning_block + '_dummy' + $file_extension_tsv)]) ~> dimdunningblockDummy\ndimdunningblockDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+ $Analytics_Folder_DUNNING_BLOCK+$file_name_dim_dunning_block+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> dimrouteTSV\ndimdunningblockDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+ $Analytics_Folder_DUNNING_BLOCK+$file_name_dim_dunning_block+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> dimrouteParquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_PAYMENT_BLOCK')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimpaymentblockDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimrouteTSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimrouteParquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tfile_name_dim_payment_block as string ('dim_payment_block'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tAnalytics_Folder_PAYMENT_BLOCK as string ('PAYMENT_BLOCK/'),\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/')\n}\nsource(output(\n\t\tPaymentBlockKey as short,\n\t\tLanguageCd as short,\n\t\tPaymentBlockCd as short,\n\t\tPaymentBlockDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_payment_block + '_dummy' + $file_extension_tsv)]) ~> dimpaymentblockDummy\ndimpaymentblockDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+ $Analytics_Folder_PAYMENT_BLOCK+$file_name_dim_payment_block+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> dimrouteTSV\ndimpaymentblockDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+ $Analytics_Folder_PAYMENT_BLOCK+$file_name_dim_payment_block+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> dimrouteParquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_PAYMENT_METHOD')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_method as string ('dim_payment_method'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_METHOD as string ('PAYMENT_METHOD/')\n}\nsource(output(\n\t\tPaymentMethodKey as short,\n\t\tCountryCd as short,\n\t\tPaymentMethCd as short,\n\t\tPaymentMethName as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_payment_method +'_dummy'+ $file_extension_tsv)]) ~> dimDummy\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_PAYMENT_METHOD+$file_name_dim_payment_method+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_PAYMENT_METHOD+$file_name_dim_payment_method+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_PAYMENT_REASON')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_reason as string ('dim_payment_reason'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_REASON as string ('PAYMENT_REASON/')\n}\nsource(output(\n\t\tPaymentReasonKey as short,\n\t\tLanguageCd as short,\n\t\tCompanyCd as short,\n\t\tPaymentReasonCd as short,\n\t\tReasonShortTxt as short,\n\t\tReasonLongTxt as short,\n\t\tCreatedDtTm as short,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd8 as timestamp,\n\t\tIsDeletedInd9 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_payment_reason +'_dummy'+ $file_extension_tsv)]) ~> dimDummy\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_PAYMENT_REASON+$file_name_dim_payment_reason+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_PAYMENT_REASON+$file_name_dim_payment_reason+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IF_ECOLABDATALAKE_AZONE_DIM_PAYMENT_TERM')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Analytics/O2CAZ"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "dimDummy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Delimited_Dataset",
								"type": "DatasetReference"
							},
							"name": "TSV"
						},
						{
							"dataset": {
								"referenceName": "Parquet_Dataset",
								"type": "DatasetReference"
							},
							"name": "Parquet"
						}
					],
					"transformations": [],
					"script": "parameters{\n\tsrc_path_dummy as string ('offshore-test/Dummy_Data/'),\n\tAnalytics_Path as string ('Analytics/EnterpriseCertified/EnterpriseDims/'),\n\tfile_name_dim_payment_term as string ('dim_payment_term'),\n\tfile_extension_tsv as string ('.tsv'),\n\tfile_extension_parquet as string ('.parquet'),\n\tAnalytics_Folder_PAYMENT_TERM as string ('PAYMENT_TERM/')\n}\nsource(output(\n\t\tPaymentTermKey as short,\n\t\tClientCd as short,\n\t\tTermsofPaymentKeyCd as short,\n\t\tValidityAreaofConditionDesc as short,\n\t\tFirstPaymentTermExplanationDesc as short,\n\t\tSecondPaymentTermExplanationDesc as short,\n\t\tNetPaymentTermExplanationDesc as short,\n\t\tCreatedDtTm as timestamp,\n\t\tLastUpdtDtTm as timestamp,\n\t\tIsDeletedInd as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:[($src_path_dummy + $file_name_dim_payment_term+'_dummy' + $file_extension_tsv)]) ~> dimDummy\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_PAYMENT_TERM+$file_name_dim_payment_term+$file_extension_tsv)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> TSV\ndimDummy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[($Analytics_Path+$Analytics_Folder_PAYMENT_TERM+$file_name_dim_payment_term+$file_extension_parquet)],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> Parquet"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Payroll_to_DeltaLake')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "WFO"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "JSON_Payroll",
								"type": "DatasetReference"
							},
							"name": "PayrollJSON"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "SrcPayrollErrorCSV"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "SrcPayrollTaskTypeTagCSV"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "SrcPayrollRecordCSV"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "PayrollErrorCSV"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "PayrollTaskTypeTagCSV"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "PayrollRecordCSV"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "PayrollErrorCSVDelete"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "PayrollTaskTypeTagCSVDelete"
						},
						{
							"linkedService": {
								"referenceName": "ADLS_gen2",
								"type": "LinkedServiceReference"
							},
							"name": "PayrollRecordCSVDelete"
						}
					],
					"transformations": [
						{
							"name": "PayrollRecordFields"
						},
						{
							"name": "PayrollRecordFileName"
						},
						{
							"name": "PayrollTaskTypeTag"
						},
						{
							"name": "PayrollTaskTypeTagFileName"
						},
						{
							"name": "PayrollErrorFields"
						},
						{
							"name": "PayrollErrorFileName"
						},
						{
							"name": "PayrollErrorCSVUniqueRunDateTime"
						},
						{
							"name": "PayrollErrorCSVToTarget"
						},
						{
							"name": "PayrollErrorCSVTargetRunDateTime"
						},
						{
							"name": "PayrollErrorCSVDeleteDeltaIfExists"
						},
						{
							"name": "PayrollTaskTypeTagCSVUniqueRunDateTime"
						},
						{
							"name": "PayrollTaskTypeTagCSVToTarget"
						},
						{
							"name": "PayrollTaskTypeTagCSVUniqueTargetRunDateTime"
						},
						{
							"name": "PayrollTaskTypeTagCSVDeleteDeltaIfExists"
						},
						{
							"name": "PayrollRecordCSVUniqueRunDateTime"
						},
						{
							"name": "PayrollRecordCSVToTarget"
						},
						{
							"name": "PayrollRecordCSVUniqueTargetRunDateTime"
						},
						{
							"name": "PayrollRecordCSVDeleteDeltaIfExists"
						}
					],
					"script": "parameters{\n\tdatePath as string ('2020/08/24/AM/'),\n\tinputRoot as string ('raw/natural/GTWFO/'),\n\toutputRoot as string ('natural/WFO/'),\n\tpayroll_partition_date as string ('2021-01-01'),\n\tpayroll_partition_time as string ('AM'),\n\tadls_container_name as string ('raw')\n}\nsource(output(\n\t\tsuccess as boolean,\n\t\tpayload as (payroll_records as (employee_id as string, employee_name as string, payroll_code as string, employee_payroll_code as string, external_id as string, payroll_description as string, date as string, task_type_id as string, task_type_tags as (id as string, value as string, tag_group as string)[], hours as string, days as string, is_confirmed as boolean, updated_at as string, time_span_type as string, time_unit_type as string, planning_unit_id as string)[], payroll_errors as (employee_id as string, employee_name as string, error_type as string, error_dates as string[])[])\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\trowUrlColumn: 'file-name',\n\tdocumentForm: 'singleDocument',\n\twildcardPaths:[($inputRoot+'payroll/'+ $datePath +'*.json')]) ~> PayrollJSON\nsource(output(\n\t\trun_date as string,\n\t\trun_time as string,\n\t\tfilename as string,\n\t\temployee_id as string,\n\t\temployee_name as string,\n\t\terror_type as string,\n\t\terror_date as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: true,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-error' + '/')) ~> SrcPayrollErrorCSV\nsource(output(\n\t\trun_date as string,\n\t\trun_time as string,\n\t\tfilename as string,\n\t\temployee_id as string,\n\t\tpayroll_code as string,\n\t\tdate as string,\n\t\ttask_type_id as string,\n\t\ttag_id as string,\n\t\ttag_group as string,\n\t\ttag_value as string,\n\t\tplanning_unit_id as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: true,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-task-type-tag' + '/')) ~> SrcPayrollTaskTypeTagCSV\nsource(output(\n\t\trun_date as string,\n\t\trun_time as string,\n\t\tfilename as string,\n\t\temployee_id as string,\n\t\temployee_name as string,\n\t\tpayroll_code as string,\n\t\tpayroll_description as string,\n\t\tdate as string,\n\t\ttask_type_id as string,\n\t\thours as string,\n\t\tdays as string,\n\t\tis_confirmed as boolean,\n\t\tupdated_at as string,\n\t\ttime_span_type as string,\n\t\ttime_unit_type as string,\n\t\tplanning_unit_id as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: true,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-record' + '/')) ~> SrcPayrollRecordCSV\nPayrollJSON foldDown(unroll(payload.payroll_records, payload.payroll_records),\n\tmapColumn(\n\t\t{file-name},\n\t\temployee_id = payload.payroll_records.employee_id,\n\t\temployee_name = payload.payroll_records.employee_name,\n\t\tpayroll_code = payload.payroll_records.payroll_code,\n\t\tpayroll_description = payload.payroll_records.payroll_description,\n\t\tdate = payload.payroll_records.date,\n\t\ttask_type_id = payload.payroll_records.task_type_id,\n\t\thours = payload.payroll_records.hours,\n\t\tdays = payload.payroll_records.days,\n\t\tis_confirmed = payload.payroll_records.is_confirmed,\n\t\tupdated_at = payload.payroll_records.updated_at,\n\t\ttime_span_type = payload.payroll_records.time_span_type,\n\t\ttime_unit_type = payload.payroll_records.time_unit_type,\n\t\tplanning_unit_id = payload.payroll_records.planning_unit_id\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> PayrollRecordFields\nPayrollRecordFields derive({file-name} = replace(replace(replace({file-name},'payroll', 'payroll-record'), $inputRoot, $outputRoot),'.json','.csv'),\n\t\toutPath = '/' + $outputRoot + \n'payroll-record'+          /* entity */\n'/'+$datePath+'WFO_'+                   /* date & WFO */\n'payroll-record'+'_'+      /* entity + _ */\nreplace(                        /* planning unit */\n    substring(\n        {file-name},\n        1 + length('/'+$inputRoot+'payroll/'+$datePath+'YYYY_MM_DD_HH_SS_payroll_')\n    ),\n    '.json', '')+\n'_'+\nreplace(                                /* timestamp without _ */\n    left(\n        substring(\n            {file-name}, \n            1 + length('/'+$inputRoot+'payroll/'+$datePath)\n        ),\n        length('YYYY_MM_DD_HH_MM')\n    ),\n    '_', '')+\n'00'+                                   /* 00 for secs */\n'.csv',\n\t\t{column_file-name} = 'WFO_'+                   /* date & WFO */\r\n'payroll-record'+'_'+      /* entity + _ */\r\nreplace(                        /* planning unit */\r\n    substring(\r\n        {file-name},\r\n        1 + length('/'+$inputRoot+'payroll/'+$datePath+'YYYY_MM_DD_HH_SS_payroll_')\r\n    ),\r\n    '.json', '')+\r\n'_'+\r\nreplace(                                /* timestamp without _ */\r\n    left(\r\n        substring(\r\n            {file-name}, \r\n            1 + length('/'+$inputRoot+'payroll/'+$datePath)\r\n        ),\r\n        length('YYYY_MM_DD_HH_MM')\r\n    ),\r\n    '_', '')+\r\n'00'+                                   /* 00 for secs */\r\n'.csv',\n\t\temployee_partition_date = $payroll_partition_date,\n\t\temployee_partition_time = $payroll_partition_time) ~> PayrollRecordFileName\nPayrollJSON foldDown(unroll(payload.payroll_records.task_type_tags),\n\tmapColumn(\n\t\t{file-name},\n\t\temployee_id = payload.payroll_records.employee_id,\n\t\tpayroll_code = payload.payroll_records.payroll_code,\n\t\tdate = payload.payroll_records.date,\n\t\ttask_type_id = payload.payroll_records.task_type_id,\n\t\ttag_id = payload.payroll_records.task_type_tags.id,\n\t\ttag_group = payload.payroll_records.task_type_tags.tag_group,\n\t\ttag_value = payload.payroll_records.task_type_tags.value,\n\t\tplanning_unit_id = payload.payroll_records.planning_unit_id\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> PayrollTaskTypeTag\nPayrollTaskTypeTag derive({file-name} = replace(replace(replace({file-name},'payroll', 'payroll-task-type-tag'), $inputRoot, $outputRoot),'.json','.csv'),\n\t\toutPath = '/' + $outputRoot + \n'payroll-task-type-tag'+          /* entity */\n'/'+$datePath+'WFO_'+                   /* date & WFO */\n'payroll-task-type-tag'+'_'+      /* entity + _ */\nreplace(                        /* planning unit */\n    substring(\n        {file-name},\n        1 + length('/'+$inputRoot+'payroll/'+$datePath+'YYYY_MM_DD_HH_SS_payroll_')\n    ),\n    '.json', '')+\n'_'+\nreplace(                                /* timestamp without _ */\n    left(\n        substring(\n            {file-name}, \n            1 + length('/'+$inputRoot+'payroll/'+$datePath)\n        ),\n        length('YYYY_MM_DD_HH_MM')\n    ),\n    '_', '')+\n'00'+                                   /* 00 for secs */\n'.csv',\n\t\t{column_file-name} = 'WFO_'+                   /* date & WFO */\r\n'payroll-task-type-tag'+'_'+      /* entity + _ */\r\nreplace(                        /* planning unit */\r\n    substring(\r\n        {file-name},\r\n        1 + length('/'+$inputRoot+'payroll/'+$datePath+'YYYY_MM_DD_HH_SS_payroll_')\r\n    ),\r\n    '.json', '')+\r\n'_'+\r\nreplace(                                /* timestamp without _ */\r\n    left(\r\n        substring(\r\n            {file-name}, \r\n            1 + length('/'+$inputRoot+'payroll/'+$datePath)\r\n        ),\r\n        length('YYYY_MM_DD_HH_MM')\r\n    ),\r\n    '_', '')+\r\n'00'+                                   /* 00 for secs */\r\n'.csv',\n\t\temployee_partition_date = $payroll_partition_date,\n\t\temployee_partition_time = $payroll_partition_time) ~> PayrollTaskTypeTagFileName\nPayrollJSON foldDown(unroll(payload.payroll_errors.error_dates, payload.payroll_errors),\n\tmapColumn(\n\t\t{file-name},\n\t\temployee_id = payload.payroll_errors.employee_id,\n\t\temployee_name = payload.payroll_errors.employee_name,\n\t\terror_type = payload.payroll_errors.error_type,\n\t\terror_date = payload.payroll_errors.error_dates\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> PayrollErrorFields\nPayrollErrorFields derive({file-name} = replace(replace(replace({file-name},'payroll', 'payroll-error'), $inputRoot, $outputRoot),'.json','.csv'),\n\t\toutPath = '/' + $outputRoot + \n'payroll-error'+          /* entity */\n'/'+$datePath+'WFO_'+                   /* date & WFO */\n'payroll-error'+'_'+      /* entity + _ */\nreplace(                        /* planning unit */\n    substring(\n        {file-name},\n        1 + length('/'+$inputRoot+'payroll/'+$datePath+'YYYY_MM_DD_HH_SS_payroll_')\n    ),\n    '.json', '')+\n'_'+\nreplace(                                /* timestamp without _ */\n    left(\n        substring(\n            {file-name}, \n            1 + length('/'+$inputRoot+'payroll/'+$datePath)\n        ),\n        length('YYYY_MM_DD_HH_MM')\n    ),\n    '_', '')+\n'00'+                                   /* 00 for secs */\n'.csv',\n\t\temployee_partition_date = $payroll_partition_date,\n\t\temployee_partition_time = $payroll_partition_time,\n\t\t{column_file-name} = 'WFO_'+                   /* date & WFO */\r\n'payroll-error'+'_'+      /* entity + _ */\r\nreplace(                        /* planning unit */\r\n    substring(\r\n        {file-name},\r\n        1 + length('/'+$inputRoot+'payroll/'+$datePath+'YYYY_MM_DD_HH_SS_payroll_')\r\n    ),\r\n    '.json', '')+\r\n'_'+\r\nreplace(                                /* timestamp without _ */\r\n    left(\r\n        substring(\r\n            {file-name}, \r\n            1 + length('/'+$inputRoot+'payroll/'+$datePath)\r\n        ),\r\n        length('YYYY_MM_DD_HH_MM')\r\n    ),\r\n    '_', '')+\r\n'00'+                                   /* 00 for secs */\r\n'.csv') ~> PayrollErrorFileName\nSrcPayrollErrorCSV aggregate(groupBy(run_date,\n\t\trun_time),\n\tagg_run_date = first(run_date),\n\t\tagg_run_time = first(run_time)) ~> PayrollErrorCSVUniqueRunDateTime\nPayrollErrorCSVUniqueRunDateTime, PayrollErrorFileName join(agg_run_date == employee_partition_date\n\t&& agg_run_time == employee_partition_time,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> PayrollErrorCSVToTarget\nPayrollErrorCSVToTarget aggregate(groupBy(agg_run_date,\n\t\tagg_run_time),\n\trun_date = first(agg_run_date),\n\t\trun_time = first(agg_run_time)) ~> PayrollErrorCSVTargetRunDateTime\nPayrollErrorCSVTargetRunDateTime alterRow(deleteIf(!isNull(run_date))) ~> PayrollErrorCSVDeleteDeltaIfExists\nSrcPayrollTaskTypeTagCSV aggregate(groupBy(run_date,\n\t\trun_time),\n\tagg_run_date = first(run_date),\n\t\tagg_run_time = first(run_time)) ~> PayrollTaskTypeTagCSVUniqueRunDateTime\nPayrollTaskTypeTagCSVUniqueRunDateTime, PayrollTaskTypeTagFileName join(agg_run_date == employee_partition_date\n\t&& agg_run_time == employee_partition_time,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> PayrollTaskTypeTagCSVToTarget\nPayrollTaskTypeTagCSVToTarget aggregate(groupBy(agg_run_date,\n\t\tagg_run_time),\n\trun_date = first(agg_run_date),\n\t\trun_time = first(agg_run_time)) ~> PayrollTaskTypeTagCSVUniqueTargetRunDateTime\nPayrollTaskTypeTagCSVUniqueTargetRunDateTime alterRow(deleteIf(!isNull(run_date))) ~> PayrollTaskTypeTagCSVDeleteDeltaIfExists\nSrcPayrollRecordCSV aggregate(groupBy(run_date,\n\t\trun_time),\n\tagg_run_date = first(run_date),\n\t\tagg_run_time = first(run_time)) ~> PayrollRecordCSVUniqueRunDateTime\nPayrollRecordCSVUniqueRunDateTime, PayrollRecordFileName join(agg_run_date == employee_partition_date\n\t&& agg_run_time == employee_partition_time,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> PayrollRecordCSVToTarget\nPayrollRecordCSVToTarget aggregate(groupBy(agg_run_date,\n\t\tagg_run_time),\n\trun_date = first(agg_run_date),\n\t\trun_time = first(agg_run_time)) ~> PayrollRecordCSVUniqueTargetRunDateTime\nPayrollRecordCSVUniqueTargetRunDateTime alterRow(deleteIf(!isNull(run_date))) ~> PayrollRecordCSVDeleteDeltaIfExists\nPayrollErrorFileName sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-error' + '/'),\n\tmergeSchema: true,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\trun_date = employee_partition_date,\n\t\trun_time = employee_partition_time,\n\t\tfilename = {column_file-name},\n\t\temployee_id,\n\t\temployee_name,\n\t\terror_type,\n\t\terror_date\n\t),\n\tpartitionBy('dynamicRange', 20,\n\t\trun_date\n\t)) ~> PayrollErrorCSV\nPayrollTaskTypeTagFileName sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-task-type-tag' + '/'),\n\tmergeSchema: true,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\trun_date = employee_partition_date,\n\t\trun_time = employee_partition_time,\n\t\tfilename = {column_file-name},\n\t\temployee_id,\n\t\tpayroll_code,\n\t\tdate,\n\t\ttask_type_id,\n\t\ttag_id,\n\t\ttag_group,\n\t\ttag_value,\n\t\tplanning_unit_id\n\t),\n\tpartitionBy('dynamicRange', 20,\n\t\trun_date\n\t)) ~> PayrollTaskTypeTagCSV\nPayrollRecordFileName sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-record' + '/'),\n\tmergeSchema: true,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\tmapColumn(\n\t\trun_date = employee_partition_date,\n\t\trun_time = employee_partition_time,\n\t\tfilename = {column_file-name},\n\t\temployee_id,\n\t\temployee_name,\n\t\tpayroll_code,\n\t\tpayroll_description,\n\t\tdate,\n\t\ttask_type_id,\n\t\thours,\n\t\tdays,\n\t\tis_confirmed,\n\t\tupdated_at,\n\t\ttime_span_type,\n\t\ttime_unit_type,\n\t\tplanning_unit_id\n\t),\n\tpartitionBy('dynamicRange', 20,\n\t\trun_date\n\t)) ~> PayrollRecordCSV\nPayrollErrorCSVDeleteDeltaIfExists sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-error' + '/'),\n\tmergeSchema: false,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:true,\n\tinsertable:false,\n\tupdateable:false,\n\tupsertable:false,\n\tkeys:['run_date','run_time'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\trun_date,\n\t\trun_time\n\t)) ~> PayrollErrorCSVDelete\nPayrollTaskTypeTagCSVDeleteDeltaIfExists sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-task-type-tag' + '/'),\n\tmergeSchema: false,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:true,\n\tinsertable:false,\n\tupdateable:false,\n\tupsertable:false,\n\tkeys:['run_date','run_time'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\trun_date,\n\t\trun_time\n\t)) ~> PayrollTaskTypeTagCSVDelete\nPayrollRecordCSVDeleteDeltaIfExists sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: ($adls_container_name),\n\tfolderPath: ($outputRoot + 'payroll-record' + '/'),\n\tmergeSchema: false,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:true,\n\tinsertable:false,\n\tupdateable:false,\n\tupsertable:false,\n\tkeys:['run_date','run_time'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\tmapColumn(\n\t\trun_date,\n\t\trun_time\n\t)) ~> PayrollRecordCSVDelete"
				}
			},
			"dependsOn": []
		}
	]
}